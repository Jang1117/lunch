<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì••êµ¬ì • ë¡œë°ì˜¤ ì ì‹¬ ë£°ë › ğŸ°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 800px;
            width: 100%;
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
            word-break: keep-all;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .info-bar {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            gap: 10px;
        }

        .info-item {
            text-align: center;
            min-width: 0;
        }

        .info-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
        }

        .slot-machine {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 40px 0;
            perspective: 1000px;
        }

        .slot {
            background: linear-gradient(145deg, #f0f0f0, #ffffff);
            border: 4px solid #667eea;
            border-radius: 15px;
            width: 200px;
            height: 250px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .slot-content {
            position: absolute;
            width: 100%;
            transition: transform 0.1s linear;
            transform: translateY(0);
            top: 0;
            left: 0;
        }

        .slot-item {
            height: 250px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            text-align: center;
        }

        .slot-emoji {
            font-size: 4em;
            margin-bottom: 10px;
            line-height: 1;
        }

        .slot-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .slot-category {
            font-size: 0.9em;
            color: #666;
            background: #f0f0f0;
            padding: 5px 10px;
            border-radius: 15px;
        }

        .controls {
            text-align: center;
            margin: 30px 0;
        }

        .spin-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 20px 60px;
            font-size: 1.5em;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            transition: all 0.3s;
            font-weight: bold;
        }

        .spin-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
        }

        .spin-button:active:not(:disabled) {
            transform: translateY(-1px);
        }

        .spin-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .result {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 15px;
            color: white;
            text-align: center;
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        .result.show {
            display: block;
        }

        .result h2 {
            font-size: 2em;
            margin-bottom: 15px;
        }

        .result-details {
            font-size: 1.2em;
            line-height: 1.8;
        }

        .manage-section {
            margin-top: 30px;
            padding: 20px;
            background: #f0f8ff;
            border-radius: 10px;
            border: 2px dashed #667eea;
        }

        .manage-section h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .restaurant-table-container {
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-height: 800px;
            overflow-y: auto;
            overflow-x: auto;
            min-height: 100px;
        }

        .restaurant-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 650px;
        }

        .restaurant-table th {
            background: #667eea;
            color: white;
            padding: 12px 8px;
            text-align: left;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
            font-size: 0.9em;
            white-space: nowrap;
        }

        .restaurant-table td {
            padding: 10px 8px;
            border-bottom: 1px solid #e0e0e0;
            vertical-align: middle;
            font-size: 0.9em;
        }

        .restaurant-table tr:hover {
            background: #f8f9fa;
        }

        .restaurant-table .emoji-cell {
            font-size: 1.5em;
            text-align: center;
            width: 50px;
        }

        .restaurant-table .name-cell {
            font-weight: bold;
            color: #333;
            width: 120px;
        }

        .restaurant-table .category-cell {
            color: #666;
            width: 80px;
            white-space: nowrap;
        }

        .restaurant-table .description-cell {
            color: #666;
            width: 150px;
            font-size: 0.85em;
        }

        .restaurant-table .price-cell {
            color: #667eea;
            font-weight: bold;
            width: 60px;
            text-align: center;
        }

        .restaurant-table .link-cell {
            width: 70px;
            text-align: center;
        }

        .restaurant-table .actions-cell {
            text-align: center;
            width: 100px;
        }

        .map-link {
            display: inline-block;
            background: #03C75A;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            text-decoration: none;
            font-size: 0.8em;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .map-link:hover {
            background: #02b350;
            transform: translateY(-1px);
        }

        .edit-button, .save-button, .cancel-button {
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
            margin: 2px 0;
            transition: all 0.3s;
            display: block;
            width: 100%;
        }

        .edit-button {
            background: #667eea;
            color: white;
        }

        .edit-button:hover {
            background: #5568d3;
        }

        .save-button {
            background: #28a745;
            color: white;
        }

        .save-button:hover {
            background: #218838;
        }

        .cancel-button {
            background: #6c757d;
            color: white;
        }

        .cancel-button:hover {
            background: #5a6268;
        }

        .delete-button-table {
            background: #ff4757;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8em;
            transition: all 0.3s;
            display: block;
            width: 100%;
            margin-top: 2px;
        }

        .delete-button-table:hover {
            background: #ee5a6f;
        }

        .edit-input {
            width: 100%;
            padding: 4px;
            border: 2px solid #667eea;
            border-radius: 4px;
            font-size: 0.85em;
        }

        .history {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .history h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .recommendation {
            margin-top: 20px;
            padding: 15px;
            background: #fff9e6;
            border-left: 4px solid #ffd700;
            border-radius: 5px;
            font-size: 0.95em;
            color: #666;
        }

        .recent-results {
            margin-top: 30px;
            padding: 20px;
            background: #fff4f4;
            border-radius: 10px;
            border: 2px solid #ff6b9d;
        }

        .recent-results h3 {
            color: #ff6b9d;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .recent-results-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .recent-result-item {
            background: white;
            padding: 15px 20px;
            border-radius: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            position: relative;
            transition: all 0.3s;
            min-width: 130px;
        }

        .recent-result-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .recent-result-emoji {
            font-size: 2em;
        }

        .recent-result-info {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .recent-result-name {
            font-weight: bold;
            color: #333;
            font-size: 1.1em;
            text-align: center;
        }

        .recent-result-category {
            font-size: 0.85em;
            color: #666;
        }

        .recent-result-delete {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #ff4757;
            color: white;
            border: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.8em;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .recent-result-delete:hover {
            background: #ee5a6f;
            transform: scale(1.1);
        }

        .recent-result-confirm {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .recent-result-confirm:hover {
            background: #218838;
            transform: translateY(-1px);
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ìµœê·¼ ë°©ë¬¸ ê¸°ë¡ í…Œì´ë¸” */
        .history-table-container {
            margin-top: 10px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            overflow-x: auto;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
        }

        .history-table th,
        .history-table td {
            padding: 8px 10px;
            border-bottom: 1px solid #e5e5e5;
            text-align: center;
            white-space: nowrap;
        }

        .history-table th {
            background: #667eea;
            color: white;
            position: sticky;
            top: 0;
            z-index: 5;
        }

        .history-table tr:hover td {
            background: #f8f9ff;
        }

        .history-delete-button {
            padding: 4px 10px;
            border: none;
            border-radius: 6px;
            background: #ff4757;
            color: white;
            font-size: 0.8em;
            cursor: pointer;
            transition: all 0.2s;
        }

        .history-delete-button:hover {
            background: #ee5a6f;
            transform: translateY(-1px);
        }

        /* ğŸ“± íƒœë¸”ë¦¿ & ëª¨ë°”ì¼ ê³µí†µ */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                padding: 20px 16px;
                border-radius: 16px;
            }

            h1 {
                font-size: 1.9em;
                line-height: 1.3;
            }

            .subtitle {
                font-size: 0.95em;
                margin-bottom: 20px;
            }

            .info-bar {
                flex-direction: column;
                align-items: stretch;
                text-align: left;
                padding: 12px;
            }

            .info-item {
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .info-label {
                font-size: 0.85em;
            }

            .info-value {
                font-size: 1em;
            }

            .slot-machine {
                display: flex;
                flex-direction: row;
                justify-content: center;
                align-items: stretch;
                gap: 8px;
                margin: 25px 0;
            }

            .slot {
                width: calc((100% - 16px) / 3);
                max-width: none;
                height: 200px;
            }

            .slot-item {
                height: 200px;
                padding: 10px;
            }

            .slot-emoji {
                font-size: 2.4em;
            }

            .slot-name {
                font-size: 0.95em;
            }

            .slot-category {
                font-size: 0.8em;
                padding: 3px 8px;
            }

            .controls {
                margin: 20px 0;
            }

            .spin-button {
                width: 100%;
                max-width: 360px;
                padding: 16px 20px;
                font-size: 1.2em;
            }

            .result {
                padding: 18px;
            }

            .result h2 {
                font-size: 1.6em;
            }

            .result-details {
                font-size: 1em;
            }

            .manage-section {
                padding: 16px;
            }

            .history,
            .recent-results {
                padding: 16px;
            }

            .history-table {
                font-size: 0.8em;
            }

            .history-table th,
            .history-table td {
                padding: 6px 6px;
            }

            .restaurant-table {
                font-size: 0.8em;
            }

            .restaurant-table th,
            .restaurant-table td {
                padding: 8px 6px;
            }

            /* ì„¤ëª…/ê°€ê²© ì»¬ëŸ¼ ëª¨ë°”ì¼ì—ì„œ ìˆ¨ê¸°ê¸° */
            .restaurant-table th:nth-child(4),
            .restaurant-table td.description-cell,
            .restaurant-table th:nth-child(5),
            .restaurant-table td.price-cell {
                display: none;
            }
        }

        /* ì•„ì£¼ ì‘ì€ í™”ë©´ (ì•„ì´í° SE ê¸‰) */
        @media (max-width: 480px) {
            h1 {
                font-size: 1.6em;
            }

            .slot {
                height: 180px;
            }

            .slot-item {
                height: 180px;
            }

            .recent-result-item {
                padding: 12px 14px;
            }

            .recent-result-name {
                font-size: 0.95em;
            }

            .map-link {
                font-size: 0.75em;
                padding: 4px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ° ì••êµ¬ì • ë¡œë°ì˜¤ ì ì‹¬ ë£°ë ›</h1>
        <p class="subtitle">ì˜¤ëŠ˜ ì ì‹¬ ë­ ë¨¹ì„ê¹Œ? ë£°ë ›ì„ ëŒë ¤ë³´ì„¸ìš”!</p>

        <div class="info-bar">
            <div class="info-item">
                <div class="info-label">ì˜¤ëŠ˜ ë‚ ì§œ</div>
                <div class="info-value" id="currentDate"></div>
            </div>
            <div class="info-item">
                <div class="info-label">ìš”ì¼</div>
                <div class="info-value" id="currentDay"></div>
            </div>
        </div>

        <div class="slot-machine">
            <div class="slot">
                <div class="slot-content" id="slot1"></div>
            </div>
            <div class="slot">
                <div class="slot-content" id="slot2"></div>
            </div>
            <div class="slot">
                <div class="slot-content" id="slot3"></div>
            </div>
        </div>

        <div class="controls">
            <button class="spin-button" id="spinButton">ğŸ° ë£°ë › ëŒë¦¬ê¸°!</button>
        </div>

        <div class="result" id="result">
            <h2>ğŸ‰ ì˜¤ëŠ˜ì˜ ì¶”ì²œ ë§›ì§‘!</h2>
            <div class="result-details" id="resultDetails"></div>
        </div>

        <div class="recommendation" id="recommendation" style="display: none;"></div>

        <div class="recent-results" id="recentResults" style="display: none;">
            <h3>ğŸ² ìµœê·¼ ë£°ë › ê²°ê³¼</h3>
            <div class="recent-results-list" id="recentResultsList"></div>
        </div>

        <div class="history">
            <h3>ğŸ“ ìµœê·¼ ë°©ë¬¸ ê¸°ë¡ (ìµœê·¼ 1ì£¼ì¼)</h3>
            <div class="history-table-container">
                <table class="history-table">
                    <thead>
                        <tr>
                            <th>ë‚ ì§œ</th>
                            <th>ìš”ì¼</th>
                            <th>ì¢…ë¥˜</th>
                            <th>ìŒì‹ì </th>
                            <th>ê´€ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody id="historyTableBody">
                        <tr>
                            <td colspan="5" style="text-align: center; color: #999; padding: 10px;">
                                ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="manage-section">
            <h3>â­ ë‚´ ë§›ì§‘ ê´€ë¦¬</h3>
            <div class="restaurant-table-container">
                <table class="restaurant-table">
                    <thead>
                        <tr>
                            <th>ğŸ­</th>
                            <th>ì´ë¦„</th>
                            <th>ì¢…ë¥˜</th>
                            <th>ì„¤ëª…</th>
                            <th>ê°€ê²©</th>
                            <th>ì§€ë„</th>
                            <th>ê´€ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody id="restaurantTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

<script>
    // ê¸°ë³¸ ì‹ë‹¹ ë¦¬ìŠ¤íŠ¸
    const defaultRestaurants = [
        { name: "ì°½ê³ 43", emoji: "ğŸ–", category: "í•œì‹", description: "ì°½ê³ ìŠ¤í˜ì…œÂ·ê¹ë‘ê¸°ë³¶ìŒë°¥", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/FSw7K4zM" },
        { name: "í‘ìš°ì •", emoji: "ğŸ¥©", category: "í•œì‹", description: "ë¸”ë™ì•µê±°ìŠ¤Â·ê½ƒê°ˆë¹„ì‚´", price: "â‚©â‚©â‚©â‚©", naverMap: "https://naver.me/G2EwpJwu" },
        { name: "ì²­ë‹´ë§Œì˜¥", emoji: "ğŸœ", category: "í•œì‹", description: "í‰ì–‘ëƒ‰ë©´Â·ì–´ë³µìŸë°˜", price: "â‚©â‚©", naverMap: "https://naver.me/x67yoaKp" },
        { name: "í™”ì—°ì‚°ì¥", emoji: "ğŸ¦", category: "ì¤‘ì‹", description: "ê³ ê¸‰ ì¤‘ì‹ ì½”ìŠ¤ ìš”ë¦¬", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/GoD7l9CG" },
        { name: "ìˆ˜ë‹¤ ì²­ë‹´ì ", emoji: "â˜•", category: "ì¹´í˜", description: "ë¸ŒëŸ°ì¹˜Â·ìƒŒë“œìœ„ì¹˜", price: "â‚©â‚©", naverMap: "https://naver.me/FjbnBQLO" },
        { name: "ìš°ì •", emoji: "ğŸ¥©", category: "í•œì‹", description: "ìˆ™ì„±í•œìš°Â·íŠ¹ë“±ì‹¬", price: "â‚©â‚©â‚©â‚©", naverMap: "https://naver.me/I55a4iNs" },
        { name: "ì •ì‹ë‹¹", emoji: "ğŸ±", category: "í•œì‹", description: "í•œì‹ íŒŒì¸ë‹¤ì´ë‹", price: "â‚©â‚©â‚©â‚©", naverMap: "https://naver.me/xv3DHt17" },
        { name: "ì¬ë”ë²„ë“œ", emoji: "ğŸ—", category: "ì–‘ì‹", description: "í”„ë¼ì´ë“œì¹˜í‚¨", price: "â‚©â‚©", naverMap: "https://naver.me/GtURVvOw" },
        { name: "íŒ”ì‹­ìƒ", emoji: "ğŸ–", category: "í•œì‹", description: "ì†Œê³ ê¸°Â·ë¼ì§€ê³ ê¸° êµ¬ì´", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/502MZmLA" },
        { name: "íˆí‚¤", emoji: "ğŸœ", category: "ì¼ì‹", description: "ë¼ë©˜ ì „ë¬¸ì ", price: "â‚©â‚©", naverMap: "https://naver.me/GrmaIyYe" },
        { name: "ì˜›ë‚ ì§‘", emoji: "ğŸ–", category: "í•œì‹", description: "ì „í†µ ê³ ê¸°êµ¬ì´", price: "â‚©â‚©", naverMap: "https://naver.me/5A3pZkyy" },
        { name: "ëˆë¸”ë‘", emoji: "ğŸ›", category: "ì¼ì‹", description: "í”„ë¦¬ë¯¸ì—„ ì‚¼ê²¹ì‚´Â·ëˆê¹ŒìŠ¤", price: "â‚©â‚©", naverMap: "https://naver.me/xTT6MS4T" },
        { name: "ë‘ë£¨", emoji: "ğŸ²", category: "í•œì‹", description: "í•œì •ì‹", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/Fjbn5tnH" },
        { name: "ì˜ë™êµì§‘", emoji: "ğŸ¥Ÿ", category: "ì¤‘ì‹", description: "ì¤‘í™”ìš”ë¦¬", price: "â‚©â‚©", naverMap: "https://naver.me/5iTd44gb" },
        { name: "ë§ˆì˜¤", emoji: "ğŸœ", category: "ì¤‘ì‹", description: "í˜„ëŒ€ì  ì¤‘ì‹ë‹¹", price: "â‚©â‚©", naverMap: "https://naver.me/IItceslH" },
        { name: "ë¬´ì•ˆíšŒê´€", emoji: "ğŸ¦", category: "í•œì‹", description: "ê½ƒê²Œì¥ ì „ë¬¸ì ", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/FJb4ZfX4" },
        { name: "ì´ëª¨ê°€ìˆëŠ”ì§‘", emoji: "ğŸ–", category: "í•œì‹", description: "ê°€ì •ì‹ ë°±ë°˜", price: "â‚©â‚©", naverMap: "https://naver.me/56R6warn" },
        { name: "ë¯¸íŠ¸í”Œë ˆì´ìŠ¤", emoji: "ğŸ¥©", category: "í•œì‹", description: "ìˆ™ì„±ê³ ê¸° ì „ë¬¸", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/xMjeb7BC" },
        { name: "ì£ ìŠ¤ë–¡ë³¶ì´", emoji: "ğŸŒ¶ï¸", category: "í•œì‹", description: "ë–¡ë³¶ì´Â·íŠ€ê¹€", price: "â‚©", naverMap: "https://naver.me/G657eZBr" },
        { name: "ìƒëŸ¬ë””", emoji: "ğŸ¥—", category: "ìƒëŸ¬ë“œ", description: "ìƒëŸ¬ë“œ ì „ë¬¸ì ", price: "â‚©â‚©", naverMap: "https://naver.me/59vQPd2h" },
        { name: "ì„¸ë¸íŒ¨í‹°ë²„ê±°", emoji: "ğŸ”", category: "ì–‘ì‹", description: "ìˆ˜ì œë²„ê±°", price: "â‚©â‚©", naverMap: "https://naver.me/5apDhkjC" },
        { name: "ë‹¤ìš´íƒ€ìš°ë„ˆ", emoji: "ğŸ”", category: "ì–‘ì‹", description: "ì•„ë³´ì¹´ë„ë²„ê±°Â·ë”ë¸”ë²„ê±°", price: "â‚©â‚©", naverMap: "https://naver.me/xY4suE7O" },
        { name: "ë„ì‚°ë¶„ì‹", emoji: "ğŸœ", category: "í•œì‹", description: "ë–¡ë³¶ì´Â·ê¹€ë°¥", price: "â‚©â‚©", naverMap: "https://naver.me/5eUcprjo" },
        { name: "ì‰ì´í¬ì‰‘", emoji: "ğŸ”", category: "ì–‘ì‹", description: "ì‰‘ë²„ê±°Â·ì¹˜ì¦ˆí”„ë¼ì´", price: "â‚©â‚©", naverMap: "https://naver.me/G58gYkfJ" },
        { name: "ì–¼ì˜¤ë¸ŒìƒŒë“œìœ„ì¹˜", emoji: "ğŸ¥ª", category: "ì–‘ì‹", description: "ìƒŒë“œìœ„ì¹˜ ì „ë¬¸ì ", price: "â‚©â‚©", naverMap: "https://naver.me/52R5GP91" },
        { name: "ë£¨ë¹„ë–¡ë³¶ì´", emoji: "ğŸŒ¶ï¸", category: "í•œì‹", description: "ë–¡ë³¶ì´Â·íŠ€ê¹€", price: "â‚©", naverMap: "https://naver.me/FUhsgOZ0" },
        { name: "ì›ì¡°ë§ˆí¬ì†Œê¸ˆêµ¬ì´", emoji: "ğŸ¥“", category: "í•œì‹", description: "ì†Œê¸ˆêµ¬ì´ ì „ë¬¸", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/5xjpqOb4" },
        { name: "ì• ì›”ì‹ë‹¹", emoji: "ğŸŸ", category: "í•œì‹", description: "ì œì£¼ ê³ ë“±ì–´Â·ê°ˆì¹˜", price: "â‚©â‚©", naverMap: "https://naver.me/GipBctR4" },
        { name: "ìƒ¤ë¸Œì¸ì„œìš¸", emoji: "ğŸ²", category: "í•œì‹", description: "ìƒ¤ë¸Œìƒ¤ë¸Œ ë·”í˜", price: "â‚©â‚©", naverMap: "https://naver.me/xucp4nA0" },
        { name: "ë„ì‚°ì •ìœ¡", emoji: "ğŸ¥©", category: "í•œì‹", description: "ì •ìœ¡ì‹ë‹¹Â·í•œìš°", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/FY3yD6Gz" },
        { name: "ìƒë¡ìˆ˜", emoji: "ğŸ–", category: "í•œì‹", description: "ë¶ˆê³ ê¸°Â·ê°ˆë¹„", price: "â‚©â‚©", naverMap: "https://naver.me/Gq84EA4Q" },
        { name: "ë¡¸ì¹´ë‘ë“¤", emoji: "ğŸ—", category: "ì–‘ì‹", description: "ë‚´ì‰¬ë¹Œ í•«ì¹˜í‚¨", price: "â‚©â‚©", naverMap: "https://naver.me/IxsqU1de" },
        { name: "ê³¨ë“œí”¼ì‰¬", emoji: "ğŸŸ", category: "ì¼ì‹", description: "í”„ë¦¬ë¯¸ì—„ ì´ˆë°¥", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/GlJIDKKR" },
        { name: "ì˜ì‚¼ì´ë„¤ìš°ì •ì†Œê°ˆë¹„", emoji: "ğŸ–", category: "í•œì‹", description: "ì†Œê°ˆë¹„ ì „ë¬¸", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/G8s9wvev" },
        { name: "ë°œì•„ë©”ë°€ë¸”ë¼ì¸", emoji: "ğŸœ", category: "í•œì‹", description: "ë©”ë°€êµ­ìˆ˜Â·ë§‰êµ­ìˆ˜", price: "â‚©â‚©", naverMap: "https://naver.me/xUw1kjYo" },
        { name: "ìŠ¤ë¯¸ì¹´ì¸ ", emoji: "ğŸ›", category: "ì¼ì‹", description: "ëˆê¹ŒìŠ¤Â·íˆë ˆì¹´ì¸ ", price: "â‚©â‚©", naverMap: "https://naver.me/xbA5vSA1" },
        { name: "ì¶”í’ë ¹ì¹¼ì‚¼ê²¹ì‚´", emoji: "ğŸ¥“", category: "í•œì‹", description: "ì¹¼ì‚¼ê²¹Â·í•­ì •ì‚´", price: "â‚©â‚©", naverMap: "https://naver.me/xNLZNOIT" },
        { name: "ë´‰ì¶”ì°œë‹­", emoji: "ğŸ—", category: "í•œì‹", description: "ì°œë‹­Â·ë³¶ìŒë°¥", price: "â‚©â‚©", naverMap: "https://naver.me/FbONRdeL" },
        { name: "í˜¸í™”ë°˜ì ", emoji: "ğŸ¥Ÿ", category: "ì¤‘ì‹", description: "ì§œì¥ë©´Â·ì§¬ë½•", price: "â‚©â‚©", naverMap: "https://naver.me/5UEc0fSt" },
        { name: "ì„¼ìì´ë£Œì¿ ", emoji: "ğŸµ", category: "ì¼ì‹", description: "ì¼ì‹ ì˜¤ë§ˆì¹´ì„¸", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/Fio7B3xv" },
        { name: "ì˜¤ë§Œë³µêµ­ìˆ˜", emoji: "ğŸœ", category: "í•œì‹", description: "êµ­ìˆ˜Â·ì¹¼êµ­ìˆ˜", price: "â‚©", naverMap: "https://naver.me/5WOkRcDp" },
        { name: "ë‰´ë§Œë‘ì§‘", emoji: "ğŸ¥Ÿ", category: "í•œì‹", description: "ë§Œë‘Â·ë§Œë‘£êµ­", price: "â‚©", naverMap: "https://naver.me/5HkaOhnl" },
        { name: "ì´ê°€ë„¤ì–‘ê¼¬ì¹˜", emoji: "ğŸ¢", category: "ì¤‘ì‹", description: "ì–‘ê¼¬ì¹˜Â·ë§ˆë¼íƒ•", price: "â‚©â‚©", naverMap: "https://naver.me/5wWetdWj" },
        { name: "ê½ƒëŒì´ë„¤", emoji: "ğŸ–", category: "í•œì‹", description: "ì‚¼ê²¹ì‚´Â·ëª©ì‚´", price: "â‚©â‚©", naverMap: "https://naver.me/53lKcfXi" },
        { name: "ì••êµ¬ì •ê³±ì°½", emoji: "ğŸ”¥", category: "í•œì‹", description: "ê³±ì°½Â·ëŒ€ì°½", price: "â‚©â‚©", naverMap: "https://naver.me/FvEgnTt6" },
        { name: "ë¬µì „", emoji: "ğŸ²", category: "í•œì‹", description: "ë¬µë°¥Â·ë„í† ë¦¬ë¬µ", price: "â‚©â‚©", naverMap: "https://naver.me/5bVsWw4I" },
        { name: "ê°•ì„œë©´ì˜¥", emoji: "ğŸœ", category: "í•œì‹", description: "í‰ì–‘ëƒ‰ë©´Â·ê°ˆë¹„íƒ•", price: "â‚©â‚©", naverMap: "https://naver.me/Fnm0z3hW" },
        { name: "í•œì†¥ë„ì‹œë½", emoji: "ğŸ±", category: "í•œì‹", description: "ë„ì‹œë½Â·ë®ë°¥", price: "â‚©", naverMap: "https://naver.me/FtTh8Z8a" },
        { name: "í˜¸ì‹œì¹´ì¸ ", emoji: "ğŸ›", category: "ì¼ì‹", description: "ëˆê¹ŒìŠ¤ ì •ì‹", price: "â‚©â‚©", naverMap: "https://naver.me/FV7YLbG0" },
        { name: "ì²­ë‹´ê³ ìˆ˜", emoji: "ğŸœ", category: "ì•„ì‹œì•ˆ", description: "ìŒ€êµ­ìˆ˜Â·ì›”ë‚¨ìŒˆ", price: "â‚©â‚©", naverMap: "https://naver.me/513NwDpD" },
        { name: "ì²­ë‹´í•´ì •", emoji: "ğŸŸ", category: "í•œì‹", description: "ë¬¼íšŒÂ·íšŒë®ë°¥", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/FW6hbr1n" },
        { name: "hen", emoji: "ğŸ—", category: "ì–‘ì‹", description: "ë¡œí‹°ì„¸ë¦¬ì¹˜í‚¨", price: "â‚©â‚©", naverMap: "https://naver.me/FW6hbr1n" },
        { name: "ì„±ë•", emoji: "ğŸ–", category: "í•œì‹", description: "í•œìš°Â·ìˆ™ì„±ê³ ê¸°", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/58NdttAs" },
        { name: "í•œì‚¬ë¦¬ê°ìíƒ•", emoji: "ğŸ²", category: "í•œì‹", description: "ê°ìíƒ•Â·ë¼ˆí•´ì¥êµ­", price: "â‚©â‚©", naverMap: "https://naver.me/GBFHlBQG" },
        { name: "ì²­ë‹´25", emoji: "ğŸ±", category: "í•œì‹", description: "í•œì •ì‹Â·ì •ê°ˆí•œì‹", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/xNLZHXq0" },
        { name: "ë¶€í¥ì™•ì¡±ë°œ", emoji: "ğŸ·", category: "í•œì‹", description: "ì¡±ë°œÂ·ë³´ìŒˆ", price: "â‚©â‚©", naverMap: "https://naver.me/56R619MD" },
        { name: "ìƒëŸ¬ë“€ë°•ìŠ¤", emoji: "ğŸ¥—", category: "ìƒëŸ¬ë“œ", description: "ìƒëŸ¬ë“œ ë³´ìš¸", price: "â‚©â‚©", naverMap: "https://naver.me/GctrC26Z" },
        { name: "ê³¨ëª©ì‹ë‹¹", emoji: "ğŸ–", category: "í•œì‹", description: "ì œìœ¡ë³¶ìŒÂ·ê¹€ì¹˜ì°Œê°œ", price: "â‚©â‚©", naverMap: "https://naver.me/5ZJaPiwW" },
        { name: "í™ì„±ì›", emoji: "ğŸ¥Ÿ", category: "ì¤‘ì‹", description: "ë”¤ì„¬Â·ìƒ¤ì˜¤ë¡±ë°”ì˜¤", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/GOPmMY5D" },
        { name: "ì²­ë‹´ë™ì¹¼êµ­ìˆ˜", emoji: "ğŸœ", category: "í•œì‹", description: "ì¹¼êµ­ìˆ˜Â·ìˆ˜ì œë¹„", price: "â‚©", naverMap: "https://naver.me/xwmqcYOo" },
        { name: "ê°•ê°•ìˆ ë˜", emoji: "ğŸŸ", category: "í•œì‹", description: "í•´ì‚°ë¬¼ì°œÂ·ì•„êµ¬ì°œ", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/5CW7bJcA" },
        { name: "ì²­ë‹´ë™ìˆœë„ë¦¬", emoji: "ğŸ–", category: "í•œì‹", description: "ìˆœëŒ€êµ­Â·ìˆœëŒ€", price: "â‚©â‚©", naverMap: "https://naver.me/FtTh7Jlq" },
        { name: "ë‹¬êµ¬ë²Œë°˜ì ", emoji: "ğŸ¥Ÿ", category: "ì¤‘ì‹", description: "ì§œì¥ë©´Â·íƒ•ìˆ˜ìœ¡", price: "â‚©â‚©", naverMap: "https://naver.me/G386bN4N" },
        { name: "ì†ŒìŠ¤", emoji: "ğŸ", category: "ì–‘ì‹", description: "íŒŒìŠ¤íƒ€Â·ë¦¬ì¡°ë˜", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/xhzCxM66" },
        { name: "ì²­ë‹´", emoji: "ğŸ±", category: "í•œì‹", description: "í•œì‹ ì½”ìŠ¤ ìš”ë¦¬", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/GALR9Vjy" }
    ];

    let restaurants = JSON.parse(localStorage.getItem('restaurants')) || [...defaultRestaurants];
    let isSpinning = false;
    let history = JSON.parse(localStorage.getItem('lunchHistory')) || [];
    let recentResults = JSON.parse(localStorage.getItem('recentResults')) || [];

    // 1ì£¼ì¼ ì§€ë‚œ ê¸°ë¡ì€ ìë™ ì‚­ì œ
    (function pruneHistoryOnLoad() {
        const now = Date.now();
        const oneWeekAgo = now - 7 * 24 * 60 * 60 * 1000;
        history = history.filter(item => item.timestamp && item.timestamp >= oneWeekAgo);
        localStorage.setItem('lunchHistory', JSON.stringify(history));
    })();

    const foodEmojis = ['ğŸ•', 'ğŸ£', 'ğŸœ', 'ğŸ', 'ğŸ”', 'ğŸ±', 'ğŸ¥—', 'ğŸ²', 'ğŸ¥©', 'ğŸ›',
                        'ğŸŒ®', 'ğŸ¥Ÿ', 'ğŸ”', 'ğŸ¥', 'ğŸ—', 'ğŸ–', 'ğŸ¦', 'ğŸ¦', 'ğŸ¤', 'ğŸ¥˜',
                        'ğŸ³', 'ğŸ¥“', 'ğŸ§‡', 'ğŸ¥', 'ğŸ°', 'ğŸ©', 'ğŸª', 'â˜•', 'ğŸµ', 'ğŸ¥¤',
                        'ğŸ½ï¸', 'ğŸ¥„', 'ğŸ´', 'ğŸ¥¢'];

    let SLOT_HEIGHT = 250;

    function updateSlotHeight() {
        const slotEl = document.querySelector('.slot');
        if (slotEl) {
            SLOT_HEIGHT = slotEl.offsetHeight || 250;
        }
    }

    const LOOPS = 20;
    function getTotalItems() {
        return Math.max(restaurants.length * LOOPS, restaurants.length);
    }

    // ë‚ ì§œ, ìš”ì¼ í‘œì‹œ
    const today = new Date();
    const days = ['ì¼ìš”ì¼', 'ì›”ìš”ì¼', 'í™”ìš”ì¼', 'ìˆ˜ìš”ì¼', 'ëª©ìš”ì¼', 'ê¸ˆìš”ì¼', 'í† ìš”ì¼'];
    document.getElementById('currentDate').textContent = `${today.getMonth() + 1}/${today.getDate()}`;
    document.getElementById('currentDay').textContent = days[today.getDay()];

    function displayRestaurants() {
        const tableBody = document.getElementById('restaurantTableBody');
        if (restaurants.length === 0) {
            tableBody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 20px; color: #999;">ì‹ë‹¹ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”</td></tr>';
            return;
        }

        tableBody.innerHTML = restaurants.map((restaurant, index) => `
            <tr id="row-${index}">
                <td class="emoji-cell">${restaurant.emoji}</td>
                <td class="name-cell">${restaurant.name}</td>
                <td class="category-cell">${restaurant.category}</td>
                <td class="description-cell">${restaurant.description}</td>
                <td class="price-cell">${restaurant.price}</td>
                <td class="link-cell">
                    ${restaurant.naverMap ? `<a href="${restaurant.naverMap}" target="_blank" class="map-link">ğŸ“ ì§€ë„</a>` : '-'}
                </td>
                <td class="actions-cell">
                    <button class="edit-button" onclick="editRestaurant(${index})">ìˆ˜ì •</button>
                    <button class="delete-button-table" onclick="deleteRestaurant(${index})">ì‚­ì œ</button>
                </td>
            </tr>
        `).join('');
    }

    function editRestaurant(index) {
        const restaurant = restaurants[index];
        const row = document.getElementById(`row-${index}`);

        row.innerHTML = `
            <td class="emoji-cell">
                <select id="edit-emoji-${index}" class="edit-input" style="font-size: 1.5em; text-align: center;">
                    ${foodEmojis.map(emoji => `<option value="${emoji}" ${emoji === restaurant.emoji ? 'selected' : ''}>${emoji}</option>`).join('')}
                </select>
            </td>
            <td class="name-cell">
                <input type="text" id="edit-name-${index}" class="edit-input" value="${restaurant.name}" maxlength="20">
            </td>
            <td class="category-cell">
                <select id="edit-category-${index}" class="edit-input">
                    <option value="í•œì‹" ${restaurant.category === 'í•œì‹' ? 'selected' : ''}>í•œì‹</option>
                    <option value="ì¤‘ì‹" ${restaurant.category === 'ì¤‘ì‹' ? 'selected' : ''}>ì¤‘ì‹</option>
                    <option value="ì¼ì‹" ${restaurant.category === 'ì¼ì‹' ? 'selected' : ''}>ì¼ì‹</option>
                    <option value="ì–‘ì‹" ${restaurant.category === 'ì–‘ì‹' ? 'selected' : ''}>ì–‘ì‹</option>
                    <option value="ì¹´í˜" ${restaurant.category === 'ì¹´í˜' ? 'selected' : ''}>ì¹´í˜</option>
                    <option value="ìƒëŸ¬ë“œ" ${restaurant.category === 'ìƒëŸ¬ë“œ' ? 'selected' : ''}>ìƒëŸ¬ë“œ</option>
                    <option value="ì•„ì‹œì•ˆ" ${restaurant.category === 'ì•„ì‹œì•ˆ' ? 'selected' : ''}>ì•„ì‹œì•ˆ</option>
                </select>
            </td>
            <td class="description-cell">
                <input type="text" id="edit-description-${index}" class="edit-input" value="${restaurant.description}" maxlength="30">
            </td>
            <td class="price-cell">
                <select id="edit-price-${index}" class="edit-input">
                    <option value="â‚©" ${restaurant.price === 'â‚©' ? 'selected' : ''}>â‚©</option>
                    <option value="â‚©â‚©" ${restaurant.price === 'â‚©â‚©' ? 'selected' : ''}>â‚©â‚©</option>
                    <option value="â‚©â‚©â‚©" ${restaurant.price === 'â‚©â‚©â‚©' ? 'selected' : ''}>â‚©â‚©â‚©</option>
                    <option value="â‚©â‚©â‚©â‚©" ${restaurant.price === 'â‚©â‚©â‚©â‚©' ? 'selected' : ''}>â‚©â‚©â‚©â‚©</option>
                </select>
            </td>
            <td class="link-cell">
                <input type="url" id="edit-map-${index}" class="edit-input" value="${restaurant.naverMap || ''}" placeholder="ì§€ë„ ë§í¬">
            </td>
            <td class="actions-cell">
                <button class="save-button" onclick="saveRestaurant(${index})">ì €ì¥</button>
                <button class="cancel-button" onclick="displayRestaurants()">ì·¨ì†Œ</button>
            </td>
        `;
    }

    function saveRestaurant(index) {
        const emoji = document.getElementById(`edit-emoji-${index}`).value;
        const name = document.getElementById(`edit-name-${index}`).value.trim();
        const category = document.getElementById(`edit-category-${index}`).value.trim();
        const description = document.getElementById(`edit-description-${index}`).value.trim();
        const price = document.getElementById(`edit-price-${index}`).value;
        const naverMap = document.getElementById(`edit-map-${index}`).value.trim();

        if (!name) {
            alert('ì‹ë‹¹ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
            return;
        }
        if (!category) {
            alert('ì¹´í…Œê³ ë¦¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
            return;
        }

        restaurants[index] = {
            name,
            emoji,
            category,
            description: description || 'ë§›ìˆëŠ” ì‹ë‹¹',
            price,
            naverMap: naverMap || ''
        };

        localStorage.setItem('restaurants', JSON.stringify(restaurants));
        displayRestaurants();
        initSlots();
    }

    function deleteRestaurant(index) {
        const restaurant = restaurants[index];
        if (confirm(`"${restaurant.name}"ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
            restaurants.splice(index, 1);
            localStorage.setItem('restaurants', JSON.stringify(restaurants));
            displayRestaurants();
            initSlots();
        }
    }

    function initSlots() {
        if (restaurants.length === 0) return;

        updateSlotHeight();
        const totalItems = getTotalItems();

        for (let i = 1; i <= 3; i++) {
            const slot = document.getElementById(`slot${i}`);
            slot.innerHTML = '';

            for (let j = 0; j < totalItems; j++) {
                const restaurant = restaurants[j % restaurants.length];
                const item = document.createElement('div');
                item.className = 'slot-item';
                item.innerHTML = `
                    <div class="slot-emoji">${restaurant.emoji}</div>
                    <div class="slot-name">${restaurant.name}</div>
                    <div class="slot-category">${restaurant.category}</div>
                `;
                slot.appendChild(item);
            }

            slot.style.transform = 'translateY(0)';
        }
    }

    function displayRecentResults() {
        const recentResultsSection = document.getElementById('recentResults');
        const recentResultsList = document.getElementById('recentResultsList');

        if (recentResults.length === 0) {
            recentResultsSection.style.display = 'none';
            return;
        }

        recentResultsSection.style.display = 'block';
        recentResultsList.innerHTML = recentResults.map((item, index) => `
            <div class="recent-result-item">
                <button class="recent-result-delete" onclick="deleteRecentResult(${index})" title="ì‚­ì œ">Ã—</button>
                <div class="recent-result-emoji">${item.emoji}</div>
                <div class="recent-result-info">
                    <div class="recent-result-name">${item.name}</div>
                    <div class="recent-result-category">${item.category}</div>
                </div>
                <button class="recent-result-confirm" onclick="confirmVisit(${index})">âœ“ ë°©ë¬¸ ì™„ë£Œ</button>
            </div>
        `).join('');
    }

    function deleteRecentResult(index) {
        recentResults.splice(index, 1);
        localStorage.setItem('recentResults', JSON.stringify(recentResults));
        displayRecentResults();
    }

    function confirmVisit(index) {
        const selected = recentResults[index];
        const now = new Date();
        const nowTs = now.getTime();
        const oneWeekAgo = nowTs - 7 * 24 * 60 * 60 * 1000;

        // 1ì£¼ì¼ ì´ì „ ê¸°ë¡ ì‚­ì œ
        history = history.filter(h => h.timestamp && h.timestamp >= oneWeekAgo);

        const dateString = `${now.getMonth() + 1}/${now.getDate()}`;
        const weekday = days[now.getDay()];

        history.push({
            name: selected.name,
            emoji: selected.emoji,
            category: selected.category,
            date: dateString,
            weekday: weekday,
            timestamp: nowTs
        });
        localStorage.setItem('lunchHistory', JSON.stringify(history));

        recentResults.splice(index, 1);
        localStorage.setItem('recentResults', JSON.stringify(recentResults));

        displayRecentResults();
        displayHistory();

        alert(`âœ… ${selected.name} ë°©ë¬¸ ê¸°ë¡ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!`);
    }

    function displayHistory() {
        const tbody = document.getElementById('historyTableBody');
        if (!tbody) return;

        if (!history || history.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="5" style="text-align: center; color: #999; padding: 10px;">
                        ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤
                    </td>
                </tr>
            `;
            return;
        }

        const reversed = history.slice().reverse();

        tbody.innerHTML = reversed.map((item, displayIndex) => {
            const originalIndex = history.length - 1 - displayIndex;
            return `
                <tr>
                    <td>${item.date || '-'}</td>
                    <td>${item.weekday || '-'}</td>
                    <td>${item.category || '-'}</td>
                    <td>${item.emoji ? item.emoji + ' ' : ''}${item.name}</td>
                    <td>
                        <button class="history-delete-button" onclick="deleteHistory(${originalIndex})">
                            ì‚­ì œ
                        </button>
                    </td>
                </tr>
            `;
        }).join('');
    }

    function deleteHistory(index) {
        history.splice(index, 1);
        localStorage.setItem('lunchHistory', JSON.stringify(history));
        displayHistory();
    }

    function getRecommendation(selected) {
        const now = new Date();
        const currentDay = days[now.getDay()];
        let recommendation = '';

        const recentVisits = history.filter(h => h.name === selected.name).length;
        if (recentVisits >= 2) {
            recommendation += `ğŸ’¡ ${selected.name}ì€(ëŠ”) ìµœê·¼ì— ${recentVisits}ë²ˆ ë°©ë¬¸í•˜ì…¨ë„¤ìš”! `;
        }

        if (currentDay === 'ì›”ìš”ì¼' && selected.category === 'ìƒëŸ¬ë“œ') {
            recommendation += 'ì›”ìš”ì¼ì—ëŠ” ê°€ë²¼ìš´ ìƒëŸ¬ë“œê°€ ì¢‹ì€ ì„ íƒì´ì—ìš”! ';
        }
        if (currentDay === 'ê¸ˆìš”ì¼' && selected.price === 'â‚©â‚©â‚©â‚©') {
            recommendation += 'ê¸ˆìš”ì¼ì—ëŠ” ì¡°ê¸ˆ íŠ¹ë³„í•œ ì‹ì‚¬ê°€ ì–´ë–¨ê¹Œìš”? ';
        }

        return recommendation || 'ì˜¤ëŠ˜ì˜ ì™„ë²½í•œ ì„ íƒì…ë‹ˆë‹¤! ë§›ìˆê²Œ ë“œì„¸ìš” ğŸ˜‹';
    }

    function spin() {
        if (isSpinning) return;
        if (restaurants.length === 0) {
            alert('ì‹ë‹¹ì„ ë¨¼ì € ì¶”ê°€í•´ì£¼ì„¸ìš”!');
            return;
        }

        isSpinning = true;
        document.getElementById('spinButton').disabled = true;
        document.getElementById('result').classList.remove('show');
        document.getElementById('recommendation').style.display = 'none';

        updateSlotHeight();

        for (let i = 1; i <= 3; i++) {
            const slot = document.getElementById(`slot${i}`);
            slot.style.transition = 'none';
            slot.style.transform = 'translateY(0)';
        }

        setTimeout(() => {
            performSpin();
        }, 100);
    }

    function performSpin() {
        const spinDurations = [2000, 2500, 3000];
        const finalIndexes = [];

        let slot1Index, slot2Index, slot3Index;
        do {
            slot1Index = Math.floor(Math.random() * restaurants.length);
            slot2Index = Math.floor(Math.random() * restaurants.length);
            slot3Index = Math.floor(Math.random() * restaurants.length);
        } while (
            slot1Index !== slot2Index &&
            slot2Index !== slot3Index &&
            slot1Index !== slot3Index
        );

        finalIndexes.push(slot1Index, slot2Index, slot3Index);

        const totalItems = getTotalItems();

        for (let i = 1; i <= 3; i++) {
            const slot = document.getElementById(`slot${i}`);
            const duration = spinDurations[i - 1];
            const finalIndex = finalIndexes[i - 1];

            let spinCount = 0;
            const maxSpins = Math.floor(duration / 50) + totalItems;

            const spinInterval = setInterval(() => {
                spinCount++;
                const idx = spinCount % totalItems;
                const currentPosition = -(idx * SLOT_HEIGHT);
                slot.style.transition = 'none';
                slot.style.transform = `translateY(${currentPosition}px)`;

                if (spinCount > maxSpins) {
                    spinCount = spinCount % totalItems;
                }
            }, 50);

            setTimeout(() => {
                clearInterval(spinInterval);

                const lastLoopStart = totalItems - restaurants.length;
                const targetIndex = lastLoopStart + finalIndex;
                const finalPosition = -(targetIndex * SLOT_HEIGHT);

                slot.style.transition = 'transform 0.5s ease-out';
                slot.style.transform = `translateY(${finalPosition}px)`;
            }, duration);
        }

        setTimeout(() => {
            let selected;
            if (finalIndexes[0] === finalIndexes[1]) {
                selected = restaurants[finalIndexes[0]];
            } else if (finalIndexes[1] === finalIndexes[2]) {
                selected = restaurants[finalIndexes[1]];
            } else {
                selected = restaurants[finalIndexes[0]];
            }

            document.getElementById('resultDetails').innerHTML = `
                <div style="font-size: 3em; margin-bottom: 15px;">${selected.emoji}</div>
                <div style="font-size: 1.8em; margin-bottom: 10px;">${selected.name}</div>
                <div style="font-size: 1.2em; margin-bottom: 10px;">${selected.category} | ${selected.price}</div>
                <div style="font-size: 1em; opacity: 0.9; margin-bottom: 15px;">${selected.description}</div>
                ${selected.naverMap ? `<a href="${selected.naverMap}" target="_blank" style="display: inline-block; background: #03C75A; color: white; padding: 12px 25px; border-radius: 25px; text-decoration: none; font-size: 1.1em; font-weight: bold; margin-top: 10px;">ğŸ“ ë„¤ì´ë²„ ì§€ë„ì—ì„œ ë³´ê¸°</a>` : ''}
            `;

            document.getElementById('result').classList.add('show');

            const recommendation = getRecommendation(selected);
            document.getElementById('recommendation').textContent = recommendation;
            document.getElementById('recommendation').style.display = 'block';

            const isDuplicate = recentResults.some(item => item.name === selected.name);
            if (!isDuplicate) {
                recentResults.push({
                    name: selected.name,
                    emoji: selected.emoji,
                    category: selected.category,
                    timestamp: Date.now()
                });
                localStorage.setItem('recentResults', JSON.stringify(recentResults));
                displayRecentResults();
            }

            isSpinning = false;
            document.getElementById('spinButton').disabled = false;
        }, 3500);
    }

    document.getElementById('spinButton').addEventListener('click', spin);

    window.addEventListener('DOMContentLoaded', function() {
        displayRestaurants();
        initSlots();
        displayRecentResults();
        displayHistory();
    });

    window.addEventListener('resize', () => {
        updateSlotHeight();
    });
</script>

</body>
</html>
