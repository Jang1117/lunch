<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì••êµ¬ì • ë¡œë°ì˜¤ ì ì‹¬ ë£°ë › ğŸ°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 800px;
            width: 100%;
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
            word-break: keep-all;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .category-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .category-button {
            background: white;
            border: 3px solid #e0e0e0;
            border-radius: 15px;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            min-width: 100px;
        }

        .category-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .category-button.active {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .category-icon {
            font-size: 2.5em;
            line-height: 1;
        }

        .category-label {
            font-size: 1em;
            font-weight: bold;
        }

        .category-count {
            font-size: 0.85em;
            opacity: 0.8;
        }

        .category-button.active .category-count {
            opacity: 1;
        }

        .info-bar {
            display: flex;
            justify-content: space-around;
            margin-bottom: 30px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            gap: 10px;
        }

        .info-item {
            text-align: center;
            min-width: 0;
        }

        .info-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .info-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
        }

        .slot-machine {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 40px 0;
            perspective: 1000px;
        }

        .slot {
            background: linear-gradient(145deg, #f0f0f0, #ffffff);
            border: 4px solid #667eea;
            border-radius: 15px;
            width: 200px;
            height: 250px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .slot-content {
            position: absolute;
            width: 100%;
            transition: transform 0.1s linear;
            transform: translateY(0);
            top: 0;
            left: 0;
        }

        .slot-item {
            height: 250px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            text-align: center;
        }

        .slot-emoji {
            font-size: 4em;
            margin-bottom: 10px;
            line-height: 1;
        }

        .slot-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .slot-category {
            font-size: 0.9em;
            color: #666;
            background: #f0f0f0;
            padding: 5px 10px;
            border-radius: 15px;
        }

        .controls {
            text-align: center;
            margin: 30px 0;
        }

        .spin-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 20px 60px;
            font-size: 1.5em;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            transition: all 0.3s;
            font-weight: bold;
        }

        .spin-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
        }

        .spin-button:active:not(:disabled) {
            transform: translateY(-1px);
        }

        .spin-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .result {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 15px;
            color: white;
            text-align: center;
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        .result.show {
            display: block;
        }

        .result h2 {
            font-size: 2em;
            margin-bottom: 15px;
        }

        .result-details {
            font-size: 1.2em;
            line-height: 1.8;
        }

        .manage-section {
            margin-top: 30px;
            padding: 20px;
            background: #f0f8ff;
            border-radius: 10px;
            border: 2px dashed #667eea;
        }

        .manage-section h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .restaurant-table-container {
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-height: 800px;
            overflow-y: auto;
            overflow-x: auto;
            min-height: 100px;
        }

        .restaurant-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 650px;
        }

        .restaurant-table th {
            background: #667eea;
            color: white;
            padding: 12px 8px;
            text-align: left;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
            font-size: 0.9em;
            white-space: nowrap;
        }

        .restaurant-table td {
            padding: 10px 8px;
            border-bottom: 1px solid #e0e0e0;
            vertical-align: middle;
            font-size: 0.9em;
        }

        .restaurant-table tbody tr {
            cursor: pointer;
            transition: background 0.2s;
        }

        .restaurant-table tbody tr:hover {
            background: #f0f8ff;
        }

        .restaurant-table tbody tr.no-link {
            cursor: default;
        }

        .restaurant-table tbody tr.no-link:hover {
            background: #f8f9fa;
        }

        .restaurant-table .emoji-cell {
            font-size: 1.5em;
            text-align: center;
            width: 50px;
        }

        .restaurant-table .name-cell {
            font-weight: 600;
            max-width: 150px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .restaurant-table .category-cell {
            max-width: 100px;
        }

        .restaurant-table .description-cell {
            max-width: 250px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .restaurant-table .action-cell {
            text-align: center;
            width: 80px;
        }

        .delete-button {
            background: #ff4757;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            transition: background 0.3s;
        }

        .delete-button:hover {
            background: #ff3838;
        }

        .add-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .form-group label {
            font-size: 0.9em;
            color: #666;
            font-weight: 600;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.95em;
            transition: border-color 0.3s;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 60px;
            grid-column: 1 / -1;
        }

        .emoji-select {
            font-size: 1.2em;
            padding: 10px;
        }

        .add-button {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1em;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .add-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .recommendation {
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            text-align: center;
            font-size: 1.1em;
            line-height: 1.6;
            display: none;
        }

        .recent-results-section {
            margin-top: 30px;
            padding: 20px;
            background: #fff5e6;
            border-radius: 10px;
            border: 2px dashed #ffa500;
            display: none;
        }

        .recent-results-section h3 {
            color: #ff8c00;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .recent-results-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .recent-result-item {
            display: flex;
            align-items: center;
            gap: 15px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: relative;
        }

        .recent-result-emoji {
            font-size: 2.5em;
            min-width: 50px;
            text-align: center;
        }

        .recent-result-info {
            flex: 1;
        }

        .recent-result-name {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .recent-result-category {
            font-size: 0.9em;
            color: #666;
        }

        .recent-result-delete {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #ff4757;
            color: white;
            border: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
            line-height: 1;
            transition: background 0.3s;
        }

        .recent-result-delete:hover {
            background: #ff3838;
        }

        .recent-result-confirm {
            background: #03C75A;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: background 0.3s;
        }

        .recent-result-confirm:hover {
            background: #02b350;
        }

        .history-section {
            margin-top: 30px;
            padding: 20px;
            background: #e8f5e9;
            border-radius: 10px;
            border: 2px dashed #4caf50;
        }

        .history-section h3 {
            color: #388e3c;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .history-table-container {
            margin-top: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-height: 400px;
            overflow-y: auto;
            overflow-x: auto;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 500px;
        }

        .history-table th {
            background: #4caf50;
            color: white;
            padding: 12px 10px;
            text-align: left;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
            font-size: 0.9em;
        }

        .history-table td {
            padding: 10px;
            border-bottom: 1px solid #e0e0e0;
            font-size: 0.9em;
        }

        .history-table tr:hover {
            background: #f1f8f4;
        }

        .history-delete-button {
            background: #ff4757;
            color: white;
            border: none;
            padding: 5px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            transition: background 0.3s;
        }

        .history-delete-button:hover {
            background: #ff3838;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            h1 {
                font-size: 1.6em;
                margin-bottom: 8px;
            }

            .subtitle {
                font-size: 0.95em;
                margin-bottom: 20px;
            }

            .category-selector {
                gap: 8px;
                margin-bottom: 20px;
            }

            .category-button {
                min-width: 70px;
                padding: 10px 12px;
            }

            .category-icon {
                font-size: 1.8em;
            }

            .category-label {
                font-size: 0.85em;
            }

            .category-count {
                font-size: 0.75em;
            }

            .info-bar {
                padding: 10px;
                margin-bottom: 20px;
                gap: 5px;
            }

            .info-label {
                font-size: 0.75em;
            }

            .info-value {
                font-size: 1em;
            }

            .slot-machine {
                flex-direction: row;
                justify-content: center;
                gap: 8px;
                margin: 25px 0;
            }

            .slot {
                width: 30%;
                min-width: 95px;
                max-width: 120px;
                height: 140px;
                border-width: 3px;
            }

            .slot-item {
                height: 140px;
                padding: 10px 5px;
            }

            .slot-emoji {
                font-size: 2.2em;
                margin-bottom: 5px;
            }

            .slot-name {
                font-size: 0.85em;
                margin-bottom: 3px;
                line-height: 1.2;
            }

            .slot-category {
                font-size: 0.7em;
                padding: 3px 6px;
            }

            .spin-button {
                padding: 15px 40px;
                font-size: 1.2em;
            }

            .result {
                padding: 20px;
                margin-top: 20px;
            }

            .result h2 {
                font-size: 1.5em;
                margin-bottom: 10px;
            }

            .result-details {
                font-size: 1em;
            }

            .recommendation {
                padding: 15px;
                font-size: 0.95em;
                margin-top: 15px;
            }

            .manage-section {
                padding: 15px;
                margin-top: 20px;
            }

            .manage-section h3 {
                font-size: 1.1em;
                margin-bottom: 12px;
            }

            .add-form {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .form-group label {
                font-size: 0.85em;
            }

            .form-group input,
            .form-group select,
            .form-group textarea {
                padding: 8px;
                font-size: 0.9em;
            }

            .add-button {
                padding: 10px 25px;
                font-size: 1em;
            }

            .recent-results-section,
            .history-section {
                padding: 15px;
                margin-top: 20px;
            }

            .recent-results-section h3,
            .history-section h3 {
                font-size: 1.1em;
                margin-bottom: 12px;
            }

            .recent-result-item {
                padding: 12px;
                gap: 12px;
            }

            .recent-result-emoji {
                font-size: 2em;
                min-width: 40px;
            }

            .recent-result-name {
                font-size: 1em;
            }

            .recent-result-category {
                font-size: 0.85em;
            }

            .recent-result-confirm {
                padding: 8px 15px;
                font-size: 0.9em;
            }

            .restaurant-table th,
            .restaurant-table td,
            .history-table th,
            .history-table td {
                padding: 8px 6px;
                font-size: 0.85em;
            }

            .delete-button,
            .history-delete-button {
                padding: 5px 10px;
                font-size: 0.8em;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 12px;
            }

            h1 {
                font-size: 1.4em;
            }

            .category-button {
                min-width: 65px;
                padding: 8px 10px;
            }

            .category-icon {
                font-size: 1.6em;
            }

            .category-label {
                font-size: 0.8em;
            }

            .slot {
                width: 31%;
                min-width: 85px;
                max-width: 110px;
                height: 130px;
            }

            .slot-item {
                height: 130px;
                padding: 8px 3px;
            }

            .slot-emoji {
                font-size: 2em;
            }

            .slot-name {
                font-size: 0.75em;
            }

            .slot-category {
                font-size: 0.65em;
                padding: 2px 5px;
            }

            .spin-button {
                padding: 12px 35px;
                font-size: 1.1em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ° ì ì‹¬ ë£°ë › ğŸ°</h1>
        <p class="subtitle">ì–´ë””ì„œ ë¨¹ì„ê¹Œ? ìš´ëª…ì— ë§¡ê²¨ë³´ì„¸ìš”!</p>

        <!-- ì¹´í…Œê³ ë¦¬ ì„ íƒ -->
        <div class="category-selector">
            <div class="category-button active" data-category="ì „ì²´" onclick="selectCategory('ì „ì²´')">
                <div class="category-icon">ğŸ½ï¸</div>
                <div class="category-label">ì „ì²´</div>
                <div class="category-count">(<span id="count-ì „ì²´">0</span>)</div>
            </div>
            <div class="category-button" data-category="í•œì‹" onclick="selectCategory('í•œì‹')">
                <div class="category-icon">ğŸ‡°ğŸ‡·</div>
                <div class="category-label">í•œì‹</div>
                <div class="category-count">(<span id="count-í•œì‹">0</span>)</div>
            </div>
            <div class="category-button" data-category="ì¤‘ì‹" onclick="selectCategory('ì¤‘ì‹')">
                <div class="category-icon">ğŸ‡¨ğŸ‡³</div>
                <div class="category-label">ì¤‘ì‹</div>
                <div class="category-count">(<span id="count-ì¤‘ì‹">0</span>)</div>
            </div>
            <div class="category-button" data-category="ì¼ì‹" onclick="selectCategory('ì¼ì‹')">
                <div class="category-icon">ğŸ‡¯ğŸ‡µ</div>
                <div class="category-label">ì¼ì‹</div>
                <div class="category-count">(<span id="count-ì¼ì‹">0</span>)</div>
            </div>
            <div class="category-button" data-category="ì–‘ì‹" onclick="selectCategory('ì–‘ì‹')">
                <div class="category-icon">wğŸ‡¹</div>
                <div class="category-label">ì–‘ì‹</div>
                <div class="category-count">(<span id="count-ì–‘ì‹">0</span>)</div>
            </div>
            <div class="category-button" data-category="ê¸°íƒ€" onclick="selectCategory('ê¸°íƒ€')">
                <div class="category-icon">ğŸŒ</div>
                <div class="category-label">ê¸°íƒ€</div>
                <div class="category-count">(<span id="count-ê¸°íƒ€">0</span>)</div>
            </div>
        </div>

        <!-- ì •ë³´ ë°” -->
        <div class="info-bar">
            <div class="info-item">
                <div class="info-label">ë“±ë¡ëœ ì‹ë‹¹</div>
                <div class="info-value"><span id="totalRestaurants">0</span>ê°œ</div>
            </div>
            <div class="info-item">
                <div class="info-label">ì„ íƒëœ ì¹´í…Œê³ ë¦¬</div>
                <div class="info-value"><span id="selectedCategory">ì „ì²´</span></div>
            </div>
            <div class="info-item">
                <div class="info-label">ì´ë²ˆ ì£¼ ë°©ë¬¸</div>
                <div class="info-value"><span id="weekVisits">0</span>íšŒ</div>
            </div>
        </div>

        <!-- ìŠ¬ë¡¯ ë¨¸ì‹  -->
        <div class="slot-machine">
            <div class="slot">
                <div class="slot-content" id="slot1"></div>
            </div>
            <div class="slot">
                <div class="slot-content" id="slot2"></div>
            </div>
            <div class="slot">
                <div class="slot-content" id="slot3"></div>
            </div>
        </div>

        <!-- ì»¨íŠ¸ë¡¤ -->
        <div class="controls">
            <button class="spin-button" id="spinButton">ëŒë¦¬ê¸°! ğŸ²</button>
        </div>

        <!-- ê²°ê³¼ -->
        <div class="result" id="result">
            <h2>ğŸ‰ ì˜¤ëŠ˜ì˜ ë©”ë‰´! ğŸ‰</h2>
            <div class="result-details" id="resultDetails"></div>
        </div>

        <!-- ì¶”ì²œ ë©”ì‹œì§€ -->
        <div class="recommendation" id="recommendation"></div>

        <!-- ìµœê·¼ ê²°ê³¼ -->
        <div class="recent-results-section" id="recentResultsSection">
            <h3>ğŸ¯ ìµœê·¼ ê²°ê³¼</h3>
            <div class="recent-results-list" id="recentResultsList"></div>
        </div>

        <!-- ë°©ë¬¸ ê¸°ë¡ -->
        <div class="history-section">
            <h3>ğŸ“… ë°©ë¬¸ ê¸°ë¡ (ìµœê·¼ 1ì£¼ì¼)</h3>
            <div class="history-table-container">
                <table class="history-table">
                    <thead>
                        <tr>
                            <th>ë‚ ì§œ</th>
                            <th>ìš”ì¼</th>
                            <th>ë¶„ë¥˜</th>
                            <th>ì‹ë‹¹</th>
                            <th>ê´€ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody id="historyTableBody">
                        <tr>
                            <td colspan="5" style="text-align: center; color: #999; padding: 10px;">
                                ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ì‹ë‹¹ ê´€ë¦¬ -->
        <div class="manage-section">
            <h3>ğŸª ì‹ë‹¹ ê´€ë¦¬</h3>
            
            <form class="add-form" id="addForm">
                <div class="form-group">
                    <label>ì‹ë‹¹ëª… *</label>
                    <input type="text" id="restaurantName" required>
                </div>

                <div class="form-group">
                    <label>ì´ëª¨ì§€ *</label>
                    <select id="restaurantEmoji" class="emoji-select" required>
                        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="ğŸ–">ğŸ– ê³ ê¸°</option>
                        <option value="ğŸ¥©">ğŸ¥© ìŠ¤í…Œì´í¬</option>
                        <option value="ğŸœ">ğŸœ ë¼ë©´/êµ­ìˆ˜</option>
                        <option value="ğŸ²">ğŸ² ì°Œê°œ/ì „ê³¨</option>
                        <option value="ğŸ±">ğŸ± ë„ì‹œë½/ì •ì‹</option>
                        <option value="ğŸ›">ğŸ› ì¹´ë ˆ/ëˆê¹ŒìŠ¤</option>
                        <option value="ğŸ—">ğŸ— ì¹˜í‚¨</option>
                        <option value="ğŸ·">ğŸ· ì¡±ë°œ/ë³´ìŒˆ</option>
                        <option value="ğŸ¥“">ğŸ¥“ ì‚¼ê²¹ì‚´</option>
                        <option value="ğŸ”¥">ğŸ”¥ ê³±ì°½</option>
                        <option value="ğŸ¦">ğŸ¦ í•´ì‚°ë¬¼</option>
                        <option value="ğŸŸ">ğŸŸ ìƒì„ /íšŒ</option>
                        <option value="ğŸ¢">ğŸ¢ ê¼¬ì¹˜</option>
                        <option value="ğŸ¥Ÿ">ğŸ¥Ÿ ë§Œë‘/ë”¤ì„¬</option>
                        <option value="ğŸŒ¶ï¸">ğŸŒ¶ï¸ ë–¡ë³¶ì´</option>
                        <option value="ğŸ”">ğŸ” í–„ë²„ê±°</option>
                        <option value="ğŸ•">ğŸ• í”¼ì</option>
                        <option value="ğŸ">ğŸ íŒŒìŠ¤íƒ€</option>
                        <option value="ğŸ¥—">ğŸ¥— ìƒëŸ¬ë“œ</option>
                        <option value="ğŸ¥ª">ğŸ¥ª ìƒŒë“œìœ„ì¹˜</option>
                        <option value="â˜•">â˜• ì¹´í˜/ë¸ŒëŸ°ì¹˜</option>
                        <option value="ğŸµ">ğŸµ ì¼ì‹/ì˜¤ë§ˆì¹´ì„¸</option>
                        <option value="ğŸ½ï¸">ğŸ½ï¸ ê¸°íƒ€</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>ë¶„ë¥˜ *</label>
                    <select id="restaurantCategory" required>
                        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="í•œì‹">í•œì‹</option>
                        <option value="ì¤‘ì‹">ì¤‘ì‹</option>
                        <option value="ì¼ì‹">ì¼ì‹</option>
                        <option value="ì–‘ì‹">ì–‘ì‹</option>
                        <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>ê°€ê²©ëŒ€ *</label>
                    <select id="restaurantPrice" required>
                        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="â‚©">â‚© (ì €ë ´)</option>
                        <option value="â‚©â‚©">â‚©â‚© (ë³´í†µ)</option>
                        <option value="â‚©â‚©â‚©">â‚©â‚©â‚© (ì•½ê°„ ë¹„ìŒˆ)</option>
                        <option value="â‚©â‚©â‚©â‚©">â‚©â‚©â‚©â‚© (ë¹„ìŒˆ)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>ì„¤ëª…</label>
                    <textarea id="restaurantDescription" placeholder="ê°„ë‹¨í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                </div>

                <div class="form-group">
                    <label>ë„¤ì´ë²„ ì§€ë„ ë§í¬ (ì„ íƒ)</label>
                    <input type="url" id="restaurantNaverMap" placeholder="https://naver.me/...">
                </div>

                <button type="submit" class="add-button">â• ì‹ë‹¹ ì¶”ê°€</button>
            </form>

            <div class="restaurant-table-container">
                <table class="restaurant-table">
                    <thead>
                        <tr>
                            <th>ì´ëª¨ì§€</th>
                            <th>ì‹ë‹¹ëª…</th>
                            <th>ë¶„ë¥˜</th>
                            <th>ê°€ê²©ëŒ€</th>
                            <th>ì„¤ëª…</th>
                            <th>ê´€ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody id="restaurantTableBody">
                        <tr>
                            <td colspan="6" style="text-align: center; color: #999; padding: 20px;">
                                ë“±ë¡ëœ ì‹ë‹¹ì´ ì—†ìŠµë‹ˆë‹¤. ìœ„ ì–‘ì‹ìœ¼ë¡œ ì‹ë‹¹ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”!
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

<script>
    let SLOT_HEIGHT = 250;
    let restaurants = [];
    let filteredRestaurants = [];
    let selectedCategoryFilter = 'ì „ì²´';
    let isSpinning = false;
    let history = [];
    let recentResults = [];
    const days = ['ì¼ìš”ì¼', 'ì›”ìš”ì¼', 'í™”ìš”ì¼', 'ìˆ˜ìš”ì¼', 'ëª©ìš”ì¼', 'ê¸ˆìš”ì¼', 'í† ìš”ì¼'];

    // í™”ë©´ í¬ê¸°ì— ë”°ë¼ ìŠ¬ë¡¯ ë†’ì´ ì„¤ì •
    function updateSlotHeightConstant() {
        if (window.innerWidth <= 480) {
            SLOT_HEIGHT = 130;
        } else if (window.innerWidth <= 768) {
            SLOT_HEIGHT = 140;
        } else {
            SLOT_HEIGHT = 250;
        }
    }

    // ê¸°ë³¸ ì‹ë‹¹ ë°ì´í„°
    const defaultRestaurants = [
        { name: "ì°½ê³ 43", emoji: "ğŸ–", category: "í•œì‹", description: "ì°½ê³ ìŠ¤í˜ì…œÂ·ê¹ë‘ê¸°ë³¶ìŒë°¥", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/FSw7K4zM" },
        { name: "í‘ìš°ì •", emoji: "ğŸ¥©", category: "í•œì‹", description: "ë¸”ë™ì•µê±°ìŠ¤Â·ê½ƒê°ˆë¹„ì‚´", price: "â‚©â‚©â‚©â‚©", naverMap: "https://naver.me/G2EwpJwu" },
        { name: "ì²­ë‹´ë§Œì˜¥", emoji: "ğŸœ", category: "í•œì‹", description: "í‰ì–‘ëƒ‰ë©´Â·ì–´ë³µìŸë°˜", price: "â‚©â‚©", naverMap: "https://naver.me/x67yoaKp" },
        { name: "í™”ì—°ì‚°ì¥", emoji: "ğŸ¦", category: "ì¤‘ì‹", description: "ê³ ê¸‰ ì¤‘ì‹ ì½”ìŠ¤ ìš”ë¦¬", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/GoD7l9CG" },
        { name: "ìˆ˜ë‹¤ ì²­ë‹´ì ", emoji: "â˜•", category: "ê¸°íƒ€", description: "ë¸ŒëŸ°ì¹˜Â·ìƒŒë“œìœ„ì¹˜", price: "â‚©â‚©", naverMap: "https://naver.me/FjbnBQLO" },
        { name: "ìš°ì •", emoji: "ğŸ¥©", category: "í•œì‹", description: "ìˆ™ì„±í•œìš°Â·íŠ¹ë“±ì‹¬", price: "â‚©â‚©â‚©â‚©", naverMap: "https://naver.me/I55a4iNs" },
        { name: "ì •ì‹ë‹¹", emoji: "ğŸ±", category: "í•œì‹", description: "í•œì‹ íŒŒì¸ë‹¤ì´ë‹", price: "â‚©â‚©â‚©â‚©", naverMap: "https://naver.me/xv3DHt17" },
        { name: "ì¬ë”ë²„ë“œ", emoji: "ğŸ—", category: "ì–‘ì‹", description: "í”„ë¼ì´ë“œì¹˜í‚¨", price: "â‚©â‚©", naverMap: "https://naver.me/GtURVvOw" },
        { name: "íŒ”ì‹­ìƒ", emoji: "ğŸ–", category: "í•œì‹", description: "ì†Œê³ ê¸°Â·ë¼ì§€ê³ ê¸° êµ¬ì´", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/502MZmLA" },
        { name: "íˆí‚¤", emoji: "ğŸœ", category: "ì¼ì‹", description: "ë¼ë©˜ ì „ë¬¸ì ", price: "â‚©â‚©", naverMap: "https://naver.me/GrmaIyYe" },
        { name: "ì˜›ë‚ ì§‘", emoji: "ğŸ–", category: "í•œì‹", description: "ì „í†µ ê³ ê¸°êµ¬ì´", price: "â‚©â‚©", naverMap: "https://naver.me/5A3pZkyy" },
        { name: "ëˆë¸”ë‘", emoji: "ğŸ›", category: "ì¼ì‹", description: "í”„ë¦¬ë¯¸ì—„ ì‚¼ê²¹ì‚´Â·ëˆê¹ŒìŠ¤", price: "â‚©â‚©", naverMap: "https://naver.me/xTT6MS4T" },
        { name: "ë‘ë£¨", emoji: "ğŸ²", category: "í•œì‹", description: "í•œì •ì‹", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/Fjbn5tnH" },
        { name: "ì˜ë™êµì§‘", emoji: "ğŸ¥Ÿ", category: "ì¤‘ì‹", description: "ì¤‘í™”ìš”ë¦¬", price: "â‚©â‚©", naverMap: "https://naver.me/5iTd44gb" },
        { name: "ë§ˆì˜¤", emoji: "ğŸœ", category: "ì¤‘ì‹", description: "í˜„ëŒ€ì  ì¤‘ì‹ë‹¹", price: "â‚©â‚©", naverMap: "https://naver.me/IItceslH" },
        { name: "ë¬´ì•ˆíšŒê´€", emoji: "ğŸ¦", category: "í•œì‹", description: "ê½ƒê²Œì¥ ì „ë¬¸ì ", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/FJb4ZfX4" },
        { name: "ì´ëª¨ê°€ìˆëŠ”ì§‘", emoji: "ğŸ–", category: "í•œì‹", description: "ê°€ì •ì‹ ë°±ë°˜", price: "â‚©â‚©", naverMap: "https://naver.me/56R6warn" },
        { name: "ë¯¸íŠ¸í”Œë ˆì´ìŠ¤", emoji: "ğŸ¥©", category: "í•œì‹", description: "ìˆ™ì„±ê³ ê¸° ì „ë¬¸", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/xMjeb7BC" },
        { name: "ì£ ìŠ¤ë–¡ë³¶ì´", emoji: "ğŸŒ¶ï¸", category: "í•œì‹", description: "ë–¡ë³¶ì´Â·íŠ€ê¹€", price: "â‚©", naverMap: "https://naver.me/G657eZBr" },
        { name: "ìƒëŸ¬ë””", emoji: "ğŸ¥—", category: "ê¸°íƒ€", description: "ìƒëŸ¬ë“œ ì „ë¬¸ì ", price: "â‚©â‚©", naverMap: "https://naver.me/59vQPd2h" },
        { name: "ì„¸ë¸íŒ¨í‹°ë²„ê±°", emoji: "ğŸ”", category: "ì–‘ì‹", description: "ìˆ˜ì œë²„ê±°", price: "â‚©â‚©", naverMap: "https://naver.me/5apDhkjC" },
        { name: "ë‹¤ìš´íƒ€ìš°ë„ˆ", emoji: "ğŸ”", category: "ì–‘ì‹", description: "ì•„ë³´ì¹´ë„ë²„ê±°Â·ë”ë¸”ë²„ê±°", price: "â‚©â‚©", naverMap: "https://naver.me/xY4suE7O" },
        { name: "ë„ì‚°ë¶„ì‹", emoji: "ğŸœ", category: "í•œì‹", description: "ë–¡ë³¶ì´Â·ê¹€ë°¥", price: "â‚©â‚©", naverMap: "https://naver.me/5eUcprjo" },
        { name: "ì‰ì´í¬ì‰‘", emoji: "ğŸ”", category: "ì–‘ì‹", description: "ì‰‘ë²„ê±°Â·ì¹˜ì¦ˆí”„ë¼ì´", price: "â‚©â‚©", naverMap: "https://naver.me/G58gYkfJ" },
        { name: "ì–¼ì˜¤ë¸ŒìƒŒë“œìœ„ì¹˜", emoji: "ğŸ¥ª", category: "ì–‘ì‹", description: "ìƒŒë“œìœ„ì¹˜ ì „ë¬¸ì ", price: "â‚©â‚©", naverMap: "https://naver.me/52R5GP91" },
        { name: "ë£¨ë¹„ë–¡ë³¶ì´", emoji: "ğŸŒ¶ï¸", category: "í•œì‹", description: "ë–¡ë³¶ì´Â·íŠ€ê¹€", price: "â‚©", naverMap: "https://naver.me/FUhsgOZ0" },
        { name: "ì›ì¡°ë§ˆí¬ì†Œê¸ˆêµ¬ì´", emoji: "ğŸ¥“", category: "í•œì‹", description: "ì†Œê¸ˆêµ¬ì´ ì „ë¬¸", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/5xjpqOb4" },
        { name: "ì• ì›”ì‹ë‹¹", emoji: "ğŸŸ", category: "í•œì‹", description: "ì œì£¼ ê³ ë“±ì–´Â·ê°ˆì¹˜", price: "â‚©â‚©", naverMap: "https://naver.me/GipBctR4" },
        { name: "ìƒ¤ë¸Œì¸ì„œìš¸", emoji: "ğŸ²", category: "í•œì‹", description: "ìƒ¤ë¸Œìƒ¤ë¸Œ ë·”í˜", price: "â‚©â‚©", naverMap: "https://naver.me/xucp4nA0" },
        { name: "ë„ì‚°ì •ìœ¡", emoji: "ğŸ¥©", category: "í•œì‹", description: "ì •ìœ¡ì‹ë‹¹Â·í•œìš°", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/FY3yD6Gz" },
        { name: "ìƒë¡ìˆ˜", emoji: "ğŸ–", category: "í•œì‹", description: "ë¶ˆê³ ê¸°Â·ê°ˆë¹„", price: "â‚©â‚©", naverMap: "https://naver.me/Gq84EA4Q" },
        { name: "ë¡¸ì¹´ë‘ë“¤", emoji: "ğŸ—", category: "ì–‘ì‹", description: "ë‚´ì‰¬ë¹Œ í•«ì¹˜í‚¨", price: "â‚©â‚©", naverMap: "https://naver.me/IxsqU1de" },
        { name: "ê³¨ë“œí”¼ì‰¬", emoji: "ğŸŸ", category: "ì¼ì‹", description: "í”„ë¦¬ë¯¸ì—„ ì´ˆë°¥", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/GlJIDKKR" },
        { name: "ì˜ì‚¼ì´ë„¤ìš°ì •ì†Œê°ˆë¹„", emoji: "ğŸ–", category: "í•œì‹", description: "ì†Œê°ˆë¹„ ì „ë¬¸", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/G8s9wvev" },
        { name: "ë°œì•„ë©”ë°€ë¸”ë¼ì¸", emoji: "ğŸœ", category: "í•œì‹", description: "ë©”ë°€êµ­ìˆ˜Â·ë§‰êµ­ìˆ˜", price: "â‚©â‚©", naverMap: "https://naver.me/xUw1kjYo" },
        { name: "ìŠ¤ë¯¸ì¹´ì¸ ", emoji: "ğŸ›", category: "ì¼ì‹", description: "ëˆê¹ŒìŠ¤Â·íˆë ˆì¹´ì¸ ", price: "â‚©â‚©", naverMap: "https://naver.me/xbA5vSA1" },
        { name: "ì¶”í’ë ¹ì¹¼ì‚¼ê²¹ì‚´", emoji: "ğŸ¥“", category: "í•œì‹", description: "ì¹¼ì‚¼ê²¹Â·í•­ì •ì‚´", price: "â‚©â‚©", naverMap: "https://naver.me/xNLZNOIT" },
        { name: "ë´‰ì¶”ì°œë‹­", emoji: "ğŸ—", category: "í•œì‹", description: "ì°œë‹­Â·ë³¶ìŒë°¥", price: "â‚©â‚©", naverMap: "https://naver.me/FbONRdeL" },
        { name: "í˜¸í™”ë°˜ì ", emoji: "ğŸ¥Ÿ", category: "ì¤‘ì‹", description: "ì§œì¥ë©´Â·ì§¬ë½•", price: "â‚©â‚©", naverMap: "https://naver.me/5UEc0fSt" },
        { name: "ì„¼ìì´ë£Œì¿ ", emoji: "ğŸµ", category: "ì¼ì‹", description: "ì¼ì‹ ì˜¤ë§ˆì¹´ì„¸", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/Fio7B3xv" },
        { name: "ì˜¤ë§Œë³µêµ­ìˆ˜", emoji: "ğŸœ", category: "í•œì‹", description: "êµ­ìˆ˜Â·ì¹¼êµ­ìˆ˜", price: "â‚©", naverMap: "https://naver.me/5WOkRcDp" },
        { name: "ë‰´ë§Œë‘ì§‘", emoji: "ğŸ¥Ÿ", category: "í•œì‹", description: "ë§Œë‘Â·ë§Œë‘£êµ­", price: "â‚©", naverMap: "https://naver.me/5HkaOhnl" },
        { name: "ì´ê°€ë„¤ì–‘ê¼¬ì¹˜", emoji: "ğŸ¢", category: "ì¤‘ì‹", description: "ì–‘ê¼¬ì¹˜Â·ë§ˆë¼íƒ•", price: "â‚©â‚©", naverMap: "https://naver.me/5wWetdWj" },
        { name: "ê½ƒëŒì´ë„¤", emoji: "ğŸ–", category: "í•œì‹", description: "ì‚¼ê²¹ì‚´Â·ëª©ì‚´", price: "â‚©â‚©", naverMap: "https://naver.me/53lKcfXi" },
        { name: "ì••êµ¬ì •ê³±ì°½", emoji: "ğŸ”¥", category: "í•œì‹", description: "ê³±ì°½Â·ëŒ€ì°½", price: "â‚©â‚©", naverMap: "https://naver.me/FvEgnTt6" },
        { name: "ë¬µì „", emoji: "ğŸ²", category: "í•œì‹", description: "ë¬µë°¥Â·ë„í† ë¦¬ë¬µ", price: "â‚©â‚©", naverMap: "https://naver.me/5bVsWw4I" },
        { name: "ê°•ì„œë©´ì˜¥", emoji: "ğŸœ", category: "í•œì‹", description: "í‰ì–‘ëƒ‰ë©´Â·ê°ˆë¹„íƒ•", price: "â‚©â‚©", naverMap: "https://naver.me/Fnm0z3hW" },
        { name: "í•œì†¥ë„ì‹œë½", emoji: "ğŸ±", category: "í•œì‹", description: "ë„ì‹œë½Â·ë®ë°¥", price: "â‚©", naverMap: "https://naver.me/FtTh8Z8a" },
        { name: "í˜¸ì‹œì¹´ì¸ ", emoji: "ğŸ›", category: "ì¼ì‹", description: "ëˆê¹ŒìŠ¤ ì •ì‹", price: "â‚©â‚©", naverMap: "https://naver.me/FV7YLbG0" },
        { name: "ì²­ë‹´ê³ ìˆ˜", emoji: "ğŸœ", category: "ê¸°íƒ€", description: "ìŒ€êµ­ìˆ˜Â·ì›”ë‚¨ìŒˆ", price: "â‚©â‚©", naverMap: "https://naver.me/513NwDpD" },
        { name: "ì²­ë‹´í•´ì •", emoji: "ğŸŸ", category: "í•œì‹", description: "ë¬¼íšŒÂ·íšŒë®ë°¥", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/FW6hbr1n" },
        { name: "hen", emoji: "ğŸ—", category: "ì–‘ì‹", description: "ë¡œí‹°ì„¸ë¦¬ì¹˜í‚¨", price: "â‚©â‚©", naverMap: "https://naver.me/FW6hbr1n" },
        { name: "ì„±ë•", emoji: "ğŸ–", category: "í•œì‹", description: "í•œìš°Â·ìˆ™ì„±ê³ ê¸°", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/58NdttAs" },
        { name: "í•œì‚¬ë¦¬ê°ìíƒ•", emoji: "ğŸ²", category: "í•œì‹", description: "ê°ìíƒ•Â·ë¼ˆí•´ì¥êµ­", price: "â‚©â‚©", naverMap: "https://naver.me/GBFHlBQG" },
        { name: "ì²­ë‹´25", emoji: "ğŸ±", category: "í•œì‹", description: "í•œì •ì‹Â·ì •ê°ˆí•œì‹", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/xNLZHXq0" },
        { name: "ë¶€í¥ì™•ì¡±ë°œ", emoji: "ğŸ·", category: "í•œì‹", description: "ì¡±ë°œÂ·ë³´ìŒˆ", price: "â‚©â‚©", naverMap: "https://naver.me/56R619MD" },
        { name: "ìƒëŸ¬ë“€ë°•ìŠ¤", emoji: "ğŸ¥—", category: "ê¸°íƒ€", description: "ìƒëŸ¬ë“œ ë³´ìš¸", price: "â‚©â‚©", naverMap: "https://naver.me/GctrC26Z" },
        { name: "ê³¨ëª©ì‹ë‹¹", emoji: "ğŸ–", category: "í•œì‹", description: "ì œìœ¡ë³¶ìŒÂ·ê¹€ì¹˜ì°Œê°œ", price: "â‚©â‚©", naverMap: "https://naver.me/5ZJaPiwW" },
        { name: "í™ì„±ì›", emoji: "ğŸ¥Ÿ", category: "ì¤‘ì‹", description: "ë”¤ì„¬Â·ìƒ¤ì˜¤ë¡±ë°”ì˜¤", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/GOPmMY5D" },
        { name: "ì²­ë‹´ë™ì¹¼êµ­ìˆ˜", emoji: "ğŸœ", category: "í•œì‹", description: "ì¹¼êµ­ìˆ˜Â·ìˆ˜ì œë¹„", price: "â‚©", naverMap: "https://naver.me/xwmqcYOo" },
        { name: "ê°•ê°•ìˆ ë˜", emoji: "ğŸŸ", category: "í•œì‹", description: "í•´ì‚°ë¬¼ì°œÂ·ì•„êµ¬ì°œ", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/5CW7bJcA" },
        { name: "ì²­ë‹´ë™ìˆœë„ë¦¬", emoji: "ğŸ–", category: "í•œì‹", description: "ìˆœëŒ€êµ­Â·ìˆœëŒ€", price: "â‚©â‚©", naverMap: "https://naver.me/FtTh7Jlq" },
        { name: "ë‹¬êµ¬ë²Œë°˜ì ", emoji: "ğŸ¥Ÿ", category: "ì¤‘ì‹", description: "ì§œì¥ë©´Â·íƒ•ìˆ˜ìœ¡", price: "â‚©â‚©", naverMap: "https://naver.me/G386bN4N" },
        { name: "ì†ŒìŠ¤", emoji: "ğŸ", category: "ì–‘ì‹", description: "íŒŒìŠ¤íƒ€Â·ë¦¬ì¡°ë˜", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/xhzCxM66" },
        { name: "ì²­ë‹´", emoji: "ğŸ±", category: "í•œì‹", description: "í•œì‹ ì½”ìŠ¤ ìš”ë¦¬", price: "â‚©â‚©â‚©", naverMap: "https://naver.me/GALR9Vjy" }
    ];

    // localStorageì—ì„œ ë°ì´í„° ë¡œë“œ
    function loadData() {
        const saved = localStorage.getItem('restaurants');
        if (saved) {
            try {
                restaurants = JSON.parse(saved);
            } catch(e) {
                restaurants = [];
            }
        }
        
        // localStorageê°€ ë¹„ì–´ìˆìœ¼ë©´ ê¸°ë³¸ ë°ì´í„° ë¡œë“œ
        if (restaurants.length === 0) {
            restaurants = defaultRestaurants.map((r, index) => ({
                ...r,
                id: Date.now() + index
            }));
            localStorage.setItem('restaurants', JSON.stringify(restaurants));
        }

        const savedHistory = localStorage.getItem('lunchHistory');
        if (savedHistory) {
            try {
                history = JSON.parse(savedHistory);
                // 1ì£¼ì¼ ì´ì „ ê¸°ë¡ ì œê±°
                const oneWeekAgo = Date.now() - 7 * 24 * 60 * 60 * 1000;
                history = history.filter(h => h.timestamp && h.timestamp >= oneWeekAgo);
                localStorage.setItem('lunchHistory', JSON.stringify(history));
            } catch(e) {
                history = [];
            }
        }

        const savedResults = localStorage.getItem('recentResults');
        if (savedResults) {
            try {
                recentResults = JSON.parse(savedResults);
            } catch(e) {
                recentResults = [];
            }
        }
    }

    // ì¹´í…Œê³ ë¦¬ ì„ íƒ
    function selectCategory(category) {
        selectedCategoryFilter = category;
        
        // ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
        document.querySelectorAll('.category-button').forEach(btn => {
            btn.classList.remove('active');
        });
        document.querySelector(`[data-category="${category}"]`).classList.add('active');

        // ì„ íƒëœ ì¹´í…Œê³ ë¦¬ í‘œì‹œ
        document.getElementById('selectedCategory').textContent = category;

        // í•„í„°ë§ëœ ì‹ë‹¹ ëª©ë¡ ì—…ë°ì´íŠ¸
        updateFilteredRestaurants();
        
        // ìŠ¬ë¡¯ ì¬ì´ˆê¸°í™”
        initSlots();
    }

    // í•„í„°ë§ëœ ì‹ë‹¹ ëª©ë¡ ì—…ë°ì´íŠ¸
    function updateFilteredRestaurants() {
        if (selectedCategoryFilter === 'ì „ì²´') {
            filteredRestaurants = [...restaurants];
        } else {
            filteredRestaurants = restaurants.filter(r => r.category === selectedCategoryFilter);
        }
    }

    // ì¹´í…Œê³ ë¦¬ë³„ ê°œìˆ˜ ì—…ë°ì´íŠ¸
    function updateCategoryCounts() {
        const categories = ['ì „ì²´', 'í•œì‹', 'ì¤‘ì‹', 'ì¼ì‹', 'ì–‘ì‹', 'ê¸°íƒ€'];
        
        categories.forEach(cat => {
            let count = 0;
            if (cat === 'ì „ì²´') {
                count = restaurants.length;
            } else {
                count = restaurants.filter(r => r.category === cat).length;
            }
            document.getElementById(`count-${cat}`).textContent = count;
        });
        
        document.getElementById('totalRestaurants').textContent = restaurants.length;
    }

    // ì‹ë‹¹ ì¶”ê°€
    document.getElementById('addForm').addEventListener('submit', function(e) {
        e.preventDefault();

        const name = document.getElementById('restaurantName').value.trim();
        const emoji = document.getElementById('restaurantEmoji').value.trim();
        const category = document.getElementById('restaurantCategory').value;
        const price = document.getElementById('restaurantPrice').value;
        const description = document.getElementById('restaurantDescription').value.trim();
        const naverMap = document.getElementById('restaurantNaverMap').value.trim();

        if (!name || !emoji || !category || !price) {
            alert('í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!');
            return;
        }

        const restaurant = {
            id: Date.now(),
            name: name,
            emoji: emoji,
            category: category,
            price: price,
            description: description || 'ë§›ìˆëŠ” ì‹ë‹¹',
            naverMap: naverMap || ''
        };

        restaurants.push(restaurant);
        localStorage.setItem('restaurants', JSON.stringify(restaurants));

        this.reset();
        displayRestaurants();
        updateFilteredRestaurants();
        initSlots();
        updateCategoryCounts();
    });

    // ì‹ë‹¹ ì‚­ì œ
    function deleteRestaurant(id) {
        if (confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
            restaurants = restaurants.filter(r => r.id !== id);
            localStorage.setItem('restaurants', JSON.stringify(restaurants));
            displayRestaurants();
            updateFilteredRestaurants();
            initSlots();
            updateCategoryCounts();
        }
    }

    // í…Œì´ë¸” í–‰ í´ë¦­ ì²˜ë¦¬
    function handleRowClick(event, naverMap) {
        // ì‚­ì œ ë²„íŠ¼ í´ë¦­ ì‹œ í–‰ í´ë¦­ ì´ë²¤íŠ¸ ë¬´ì‹œ
        if (event.target.classList.contains('delete-button')) {
            return;
        }
        
        // ë„¤ì´ë²„ ì§€ë„ ë§í¬ê°€ ìˆìœ¼ë©´ ìƒˆ ì°½ìœ¼ë¡œ ì—´ê¸°
        if (naverMap && naverMap.trim() !== '') {
            window.open(naverMap, '_blank');
        }
    }

    // ì‹ë‹¹ ëª©ë¡ í‘œì‹œ
    function displayRestaurants() {
        const tbody = document.getElementById('restaurantTableBody');
        
        if (restaurants.length === 0) {
            tbody.innerHTML = `
                <tr class="no-link">
                    <td colspan="6" style="text-align: center; color: #999; padding: 20px;">
                        ë“±ë¡ëœ ì‹ë‹¹ì´ ì—†ìŠµë‹ˆë‹¤. ìœ„ ì–‘ì‹ìœ¼ë¡œ ì‹ë‹¹ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”!
                    </td>
                </tr>
            `;
            return;
        }

        tbody.innerHTML = restaurants.map(r => {
            const hasLink = r.naverMap && r.naverMap.trim() !== '';
            const rowClass = hasLink ? '' : 'no-link';
            const cursorStyle = hasLink ? 'cursor: pointer;' : '';
            
            return `
                <tr class="${rowClass}" onclick="handleRowClick(event, '${r.naverMap || ''}')" style="${cursorStyle}">
                    <td class="emoji-cell">${r.emoji}</td>
                    <td class="name-cell" title="${r.name}">${r.name}</td>
                    <td class="category-cell">${r.category}</td>
                    <td>${r.price}</td>
                    <td class="description-cell" title="${r.description}">${r.description}</td>
                    <td class="action-cell">
                        <button class="delete-button" onclick="deleteRestaurant(${r.id})">ì‚­ì œ</button>
                    </td>
                </tr>
            `;
        }).join('');
    }

    // ìŠ¬ë¡¯ ì´ˆê¸°í™”
    function initSlots() {
        updateSlotHeightConstant();
        updateFilteredRestaurants();
        
        if (filteredRestaurants.length === 0) {
            for (let i = 1; i <= 3; i++) {
                document.getElementById(`slot${i}`).innerHTML = `
                    <div class="slot-item">
                        <div class="slot-emoji">â“</div>
                        <div class="slot-name">ì‹ë‹¹ ì—†ìŒ</div>
                    </div>
                `;
            }
            return;
        }

        const repeatCount = Math.max(3, Math.ceil(20 / filteredRestaurants.length));
        
        for (let i = 1; i <= 3; i++) {
            const slot = document.getElementById(`slot${i}`);
            let content = '';
            
            for (let j = 0; j < repeatCount; j++) {
                filteredRestaurants.forEach(restaurant => {
                    content += `
                        <div class="slot-item">
                            <div class="slot-emoji">${restaurant.emoji}</div>
                            <div class="slot-name">${restaurant.name}</div>
                            <div class="slot-category">${restaurant.category}</div>
                        </div>
                    `;
                });
            }
            
            slot.innerHTML = content;
        }
    }

    function getTotalItems() {
        if (filteredRestaurants.length === 0) return 1;
        const repeatCount = Math.max(3, Math.ceil(20 / filteredRestaurants.length));
        return filteredRestaurants.length * repeatCount;
    }

    function updateSlotHeight() {
        // ìŠ¬ë¡¯ ë†’ì´ ì—…ë°ì´íŠ¸ (í•„ìš”ì‹œ)
    }

    // ìµœê·¼ ê²°ê³¼ í‘œì‹œ
    function displayRecentResults() {
        const recentResultsSection = document.getElementById('recentResultsSection');
        const recentResultsList = document.getElementById('recentResultsList');

        if (recentResults.length === 0) {
            recentResultsSection.style.display = 'none';
            return;
        }

        recentResultsSection.style.display = 'block';
        recentResultsList.innerHTML = recentResults.map((item, index) => `
            <div class="recent-result-item">
                <button class="recent-result-delete" onclick="deleteRecentResult(${index})" title="ì‚­ì œ">Ã—</button>
                <div class="recent-result-emoji">${item.emoji}</div>
                <div class="recent-result-info">
                    <div class="recent-result-name">${item.name}</div>
                    <div class="recent-result-category">${item.category}</div>
                </div>
                <button class="recent-result-confirm" onclick="confirmVisit(${index})">âœ“ ë°©ë¬¸ ì™„ë£Œ</button>
            </div>
        `).join('');
    }

    function deleteRecentResult(index) {
        recentResults.splice(index, 1);
        localStorage.setItem('recentResults', JSON.stringify(recentResults));
        displayRecentResults();
    }

    function confirmVisit(index) {
        const selected = recentResults[index];
        const now = new Date();
        const nowTs = now.getTime();
        const oneWeekAgo = nowTs - 7 * 24 * 60 * 60 * 1000;

        history = history.filter(h => h.timestamp && h.timestamp >= oneWeekAgo);

        const dateString = `${now.getMonth() + 1}/${now.getDate()}`;
        const weekday = days[now.getDay()];

        history.push({
            name: selected.name,
            emoji: selected.emoji,
            category: selected.category,
            date: dateString,
            weekday: weekday,
            timestamp: nowTs
        });
        localStorage.setItem('lunchHistory', JSON.stringify(history));

        recentResults.splice(index, 1);
        localStorage.setItem('recentResults', JSON.stringify(recentResults));

        displayRecentResults();
        displayHistory();
    }

    // ë°©ë¬¸ ê¸°ë¡ í‘œì‹œ
    function displayHistory() {
        const tbody = document.getElementById('historyTableBody');
        if (!tbody) return;

        if (!history || history.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="5" style="text-align: center; color: #999; padding: 10px;">
                        ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤
                    </td>
                </tr>
            `;
            return;
        }

        const reversed = history.slice().reverse();

        tbody.innerHTML = reversed.map((item, displayIndex) => {
            const originalIndex = history.length - 1 - displayIndex;
            return `
                <tr>
                    <td>${item.date || '-'}</td>
                    <td>${item.weekday || '-'}</td>
                    <td>${item.category || '-'}</td>
                    <td>${item.emoji ? item.emoji + ' ' : ''}${item.name}</td>
                    <td>
                        <button class="history-delete-button" onclick="deleteHistory(${originalIndex})">
                            ì‚­ì œ
                        </button>
                    </td>
                </tr>
            `;
        }).join('');

        // ì´ë²ˆ ì£¼ ë°©ë¬¸ íšŸìˆ˜ ì—…ë°ì´íŠ¸
        document.getElementById('weekVisits').textContent = history.length;
    }

    function deleteHistory(index) {
        history.splice(index, 1);
        localStorage.setItem('lunchHistory', JSON.stringify(history));
        displayHistory();
    }

    function getRecommendation(selected) {
        const now = new Date();
        const currentDay = days[now.getDay()];
        let recommendation = '';

        const recentVisits = history.filter(h => h.name === selected.name).length;
        if (recentVisits >= 2) {
            recommendation += `ğŸ’¡ ${selected.name}ì€(ëŠ”) ìµœê·¼ì— ${recentVisits}ë²ˆ ë°©ë¬¸í•˜ì…¨ë„¤ìš”! `;
        }

        if (currentDay === 'ì›”ìš”ì¼' && selected.category === 'ìƒëŸ¬ë“œ') {
            recommendation += 'ì›”ìš”ì¼ì—ëŠ” ê°€ë²¼ìš´ ìƒëŸ¬ë“œê°€ ì¢‹ì€ ì„ íƒì´ì—ìš”! ';
        }
        if (currentDay === 'ê¸ˆìš”ì¼' && selected.price === 'â‚©â‚©â‚©â‚©') {
            recommendation += 'ê¸ˆìš”ì¼ì—ëŠ” ì¡°ê¸ˆ íŠ¹ë³„í•œ ì‹ì‚¬ê°€ ì–´ë–¨ê¹Œìš”? ';
        }

        return recommendation || 'ì˜¤ëŠ˜ì˜ ì™„ë²½í•œ ì„ íƒì…ë‹ˆë‹¤! ë§›ìˆê²Œ ë“œì„¸ìš” ğŸ˜‹';
    }

    // ë£°ë › ëŒë¦¬ê¸°
    function spin() {
        if (isSpinning) return;
        if (filteredRestaurants.length === 0) {
            alert(`${selectedCategoryFilter} ì¹´í…Œê³ ë¦¬ì— ë“±ë¡ëœ ì‹ë‹¹ì´ ì—†ìŠµë‹ˆë‹¤!`);
            return;
        }

        isSpinning = true;
        document.getElementById('spinButton').disabled = true;
        document.getElementById('result').classList.remove('show');
        document.getElementById('recommendation').style.display = 'none';

        updateSlotHeight();

        for (let i = 1; i <= 3; i++) {
            const slot = document.getElementById(`slot${i}`);
            slot.style.transition = 'none';
            slot.style.transform = 'translateY(0)';
        }

        setTimeout(() => {
            performSpin();
        }, 100);
    }

    function performSpin() {
        const spinDurations = [2000, 2500, 3000];
        const finalIndexes = [];

        let slot1Index, slot2Index, slot3Index;
        do {
            slot1Index = Math.floor(Math.random() * filteredRestaurants.length);
            slot2Index = Math.floor(Math.random() * filteredRestaurants.length);
            slot3Index = Math.floor(Math.random() * filteredRestaurants.length);
        } while (
            slot1Index !== slot2Index &&
            slot2Index !== slot3Index &&
            slot1Index !== slot3Index
        );

        finalIndexes.push(slot1Index, slot2Index, slot3Index);

        const totalItems = getTotalItems();

        for (let i = 1; i <= 3; i++) {
            const slot = document.getElementById(`slot${i}`);
            const duration = spinDurations[i - 1];
            const finalIndex = finalIndexes[i - 1];

            let spinCount = 0;
            const maxSpins = Math.floor(duration / 50) + totalItems;

            const spinInterval = setInterval(() => {
                spinCount++;
                const idx = spinCount % totalItems;
                const currentPosition = -(idx * SLOT_HEIGHT);
                slot.style.transition = 'none';
                slot.style.transform = `translateY(${currentPosition}px)`;

                if (spinCount > maxSpins) {
                    spinCount = spinCount % totalItems;
                }
            }, 50);

            setTimeout(() => {
                clearInterval(spinInterval);

                const lastLoopStart = totalItems - filteredRestaurants.length;
                const targetIndex = lastLoopStart + finalIndex;
                const finalPosition = -(targetIndex * SLOT_HEIGHT);

                slot.style.transition = 'transform 0.5s ease-out';
                slot.style.transform = `translateY(${finalPosition}px)`;
            }, duration);
        }

        setTimeout(() => {
            let selected;
            if (finalIndexes[0] === finalIndexes[1]) {
                selected = filteredRestaurants[finalIndexes[0]];
            } else if (finalIndexes[1] === finalIndexes[2]) {
                selected = filteredRestaurants[finalIndexes[1]];
            } else {
                selected = filteredRestaurants[finalIndexes[0]];
            }

            document.getElementById('resultDetails').innerHTML = `
                <div style="font-size: 3em; margin-bottom: 15px;">${selected.emoji}</div>
                <div style="font-size: 1.8em; margin-bottom: 10px;">${selected.name}</div>
                <div style="font-size: 1.2em; margin-bottom: 10px;">${selected.category} | ${selected.price}</div>
                <div style="font-size: 1em; opacity: 0.9; margin-bottom: 15px;">${selected.description}</div>
                ${selected.naverMap ? `<a href="${selected.naverMap}" target="_blank" style="display: inline-block; background: #03C75A; color: white; padding: 12px 25px; border-radius: 25px; text-decoration: none; font-size: 1.1em; font-weight: bold; margin-top: 10px;">ğŸ“ ë„¤ì´ë²„ ì§€ë„ì—ì„œ ë³´ê¸°</a>` : ''}
            `;

            document.getElementById('result').classList.add('show');

            const recommendation = getRecommendation(selected);
            document.getElementById('recommendation').textContent = recommendation;
            document.getElementById('recommendation').style.display = 'block';

            const isDuplicate = recentResults.some(item => item.name === selected.name);
            if (!isDuplicate) {
                recentResults.push({
                    name: selected.name,
                    emoji: selected.emoji,
                    category: selected.category,
                    timestamp: Date.now()
                });
                localStorage.setItem('recentResults', JSON.stringify(recentResults));
                displayRecentResults();
            }

            isSpinning = false;
            document.getElementById('spinButton').disabled = false;
        }, 3500);
    }

    document.getElementById('spinButton').addEventListener('click', spin);

    window.addEventListener('DOMContentLoaded', function() {
        loadData();
        displayRestaurants();
        updateFilteredRestaurants();
        initSlots();
        updateCategoryCounts();
        displayRecentResults();
        displayHistory();
    });

    window.addEventListener('resize', () => {
        updateSlotHeightConstant();
        updateSlotHeight();
    });
</script>

</body>
</html>
